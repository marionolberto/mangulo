// P370_Functions.cpp: implementation of the CP370_Functions class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "SMS4DC.h"
#include "P370_Functions.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

CP370_Functions::CP370_Functions()
{

}

CP370_Functions::~CP370_Functions()
{

}



double CP370_Functions::P370_7(double f,double t,int p,double h1,double d_km,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double ttca,double *Ebfs) 
{
	double Eb,E0fs;

	if (((f>=30.0) && (f<=250.0)) || ((f>=450.0) && (f<=1000.0)))
		Eb=P370_6(f,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&E0fs);
	else if ( (f>250.0) && (f<450.0))
	{
		double finf,fsup,Efsinf,Efssup,Ebinf,Ebsup;
		finf=250.0;fsup=450.0;
		Ebinf=P370_6(finf,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efsinf);
		Ebsup=P370_6(fsup,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efssup);
		Eb=Ebinf+(Ebsup-Ebinf)*log10(f/finf)/log10(fsup/finf);
		E0fs=Efsinf+(Efssup-Efsinf)*log10(f/finf)/log10(fsup/finf);
	}   
	else if (f<30.0)
	{
		double finf,fsup,Efsinf,Efssup,Ebinf,Ebsup;
		finf=30.0;fsup=250.0;
		Ebinf=P370_6(finf,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efsinf);
		Ebsup=P370_6(fsup,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efssup);
		Eb=Ebinf+(Ebsup-Ebinf)*log10(f/finf)/log10(fsup/finf);
		E0fs=Efsinf+(Efssup-Efsinf)*log10(f/finf)/log10(fsup/finf);
	}   
	else if (f>1000.0)
	{
		double finf,fsup,Efsinf,Efssup,Ebinf,Ebsup;
		finf=450.0;fsup=1000.0;
		Ebinf=P370_6(finf,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efsinf);
		Ebsup=P370_6(fsup,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,ttca,&Efssup);
		Eb=Ebinf+(Ebsup-Ebinf)*log10(f/finf)/log10(fsup/finf);
		E0fs=Efsinf+(Efssup-Efsinf)*log10(f/finf)/log10(fsup/finf);
	}   
	*Ebfs=E0fs;
	Eb=min(Eb,E0fs);
	return Eb;
}

double CP370_Functions::P370_6(double f,double t,int p,double h1,double d_km,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double ttca,double *Ebfs) 
{
	double Eb,E0fs,corr_ca,Ecorr;

	Eb=P370_5(f,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&E0fs);
	corr_ca=TCAcorr370(ttca,f);

	// if p==1
	//   corr_dh=zdelta_h_cr(f,d_km,dh);
	// else
	//   corr_dh=0;
	// end 
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	//Ecorr = corr_ca - corr_dh;
	Ecorr = corr_ca;
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	Eb=Eb+Ecorr;
	*Ebfs=E0fs;
	Eb=min(Eb,E0fs);
	return Eb;
}

double CP370_Functions::P370_5(double f,double t,int p,double h1,double d_km,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double *Ebfs) 
{
	t=min(max(t,1),50);
	double tinf,tsup,Qt,Qinf,Qsup,Einf,Efsinf,Esup,Efssup,Eb,E0fs;

	if ( ((f>=450.0) && (f<=1000.0)) && ((t>1.0) && (t<10.0)) && p==1)
	{
	   tinf=1.0;	tsup=10.0;
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Einf=P370_4(f,tinf,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&Efsinf);
	   Esup=P370_4(f,tsup,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&Efssup);

	   Eb=Esup*(Qinf-Qt)/(Qinf-Qsup)+Einf*(Qt-Qsup)/(Qinf-Qsup);
	   *Ebfs=Efssup*(Qinf-Qt)/(Qinf-Qsup)+Efsinf*(Qt-Qsup)/(Qinf-Qsup);
	}

	else if ( (t==1.0) || (t==5.0) || (t==10.0) || (t==50.0) ) 
	{
		Eb=P370_4(f,t,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&E0fs);
		*Ebfs=E0fs;
	}
	else
	{
	   if ((t>1.0) && (t<5.0) )
	   {
		   tinf=1.0;tsup=5.0;
	   }
	   else if ( (t>5.0) && (t<10.0) )
	   {
		   tinf=5.0;tsup=10.0;
	   }
	   else if ( (t>10.0) && (t<50.0) )
	   {
		   tinf=10.0;tsup=50.0;
	   }
   
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Einf=P370_4(f,tinf,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&Efsinf);
	   Esup=P370_4(f,tsup,p,h1,d_km,tetamax15,h2,ENV,Lp,syst,&Efssup);

	   Eb=Esup*(Qinf-Qt)/(Qinf-Qsup)+Einf*(Qt-Qsup)/(Qinf-Qsup);
	   *Ebfs=Efssup*(Qinf-Qt)/(Qinf-Qsup)+Efsinf*(Qt-Qsup)/(Qinf-Qsup);
	}
	return Eb;

}


double CP370_Functions::Qi(double x)
{
	x=min(100.0-0.0000001,max(0.0000001,x));
	x=x/100.0;

	double  c0=2.515517,		c1=0.802853,		c2=0.010328,
			d1=1.432788,		d2=0.189269,		d3=0.001308;
	double T,P1,P2,P,Qi;

	if ( x<=0.5 )
	{
		T=sqrt(-2*log(x));
		P1=((c2*T+c1)*T)+c0;
		P2=((d3*T+d2)*T+d1)*T+1;
		P=P1/P2;
		Qi=T-P;
	}
	else
	{
		T=sqrt(-2*log(1-x));
		P1=((c2*T+c1)*T)+c0;
		P2=((d3*T+d2)*T+d1)*T+1;
		P=P1/P2;
		Qi=-(T-P);
	}
	return Qi;

}

double CP370_Functions::P370_4(double f,double t,int p,double h1,double d_km,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double *Ebfs) 
{
	int i;
	double Eb,E0fs  ,corr,cort[15];
	double cort1[15]={19.0313, 16.7857, 13.4393, 10.3571, 6.6585, 3.9726, 1.727, 0, -1.7955, -4.0851, -6.6389, -10.4256, -13.5078, -16.8542, -18.9237};
	double cort2[15]={11.7661, 10.4012, 8.3757, 6.4824, 4.0607, 2.5636, 1.1546, 0, -1.047, -2.3679, -3.9971, -6.2867, -8.18, -10.2495, -11.4384};
	double cort3[15]={21.6309, 19.082, 15.3906, 11.875, 7.6563, 4.4922, 2.0313, 0, -2.0117, -4.4727, -7.6367, -11.7676, -15.2832, -19.0625, -21.5234};
	double cort4[15]={12.8418, 11.3477, 9.0625, 6.9531, 4.3164, 2.5586, 1.1523, 0, -1.3086, -2.7148, -4.4727, -7.1094, -9.043, -11.3281, -12.9102};

	if (Lp==50.0)		corr=0.0;
	else
	{
		double Lpt[15]={1, 2, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 95, 98, 99};
		if ( (f>=30.0) && (f<=250.0) )
		{
			if (syst==0)  //A
				for (i=0;i<15;i++)			cort[i]=cort1[i];
			else if (syst==1)  //D 
				for (i=0;i<15;i++)			cort[i]=cort2[i];
		}   
		else if ( (f>=450.0) && (f<=1000.0) )
		{
			if (syst==0)  //A
				for (i=0;i<15;i++)			cort[i]=cort3[i];
			else if (syst==1)  //D 
				for (i=0;i<15;i++)			cort[i]=cort4[i];
		}
		corr=Interp2(Lpt,cort,Lp,15);
	} 
	Eb=P370_3(f,t,p,h1,d_km,tetamax15,h2,ENV,&E0fs);
	*Ebfs=E0fs;
	Eb=Eb+corr;
	return Eb;
}


double CP370_Functions::zdelta_h_cr(double f,double d,double dh)
{
	double y0[9],y;
	double dh0[9]={10, 20, 30, 50, 80, 100, 150, 300, 500};

	for (int j=0;j<9;j++)
		y0[j]=zdelta_h_cr_2(f,d,dh0[j]);
	y = Interp2(dh0,y0,dh,9);
	return y;
}

double CP370_Functions::zdelta_h_cr_2(double f,double d,double dh)
{
	double D0[34]={1 ,10, 15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80 ,90, 100, 150, 200, 250, 300,
		350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1100};

	double y0[34],y;

	if ( (dh==10) ||(dh==20) ||(dh==30) ||(dh==50) ||(dh==80) ||(dh==100) ||(dh==150) ||(dh==300) ||(dh==500) )
	{
		for (int j=0;j<34;j++)
			y0[j]=zdelta_h_cr_1(f,D0[j],dh);
		y = Interp2(D0,y0,d,34);
	}
	return y;
}

double CP370_Functions::zdelta_h_cr_1(double f,double di,double dh)
{
	double p1,p2;
	 if ( (f>=30.0) && (f<=250.0) )
	 {
		p1 = -7.1154*(dh==10.0) +	(-4.1346)*(dh==20.0) +
			(-2.5962)*(dh==30.0) +	0.0*(dh==50.0) +
			2.8846*(dh==80.0) + 	4.9038*(dh==100.0) +
			7.8846*(dh==150.0) +	13.8942*(dh==300.0) +	18.8942*(dh==500.0);

		p2 = -3.125*(dh==10.0) +	(-2.1154)*(dh==20.0) +
			(-1.6346)*(dh==30.0) +	0.0*(dh==50.0) +
			1.875*(dh==80.0) + 	2.8846*(dh==100.0) +
			4.375*(dh==150.0) +	7.8846*(dh==300.0) +	9.4231*(dh==500.0);
	 }
	 else if ((f>=450.0) && (f<=1000.0) )
	 {
		p1 = -10*(dh==10.0) +	(-5.0)*(dh==20.0) +
			(-2.0)*(dh==30.0) +	0.0*(dh==50.0) +
			3.9979*(dh==80.0) + 	7.0203*(dh==100.0) +
			9.8028*(dh==150.0) +	19.9733*(dh==300.0) +	27.9371*(dh==500.0);

		p2 = -5*(dh==10.0) +	(-2.9104)*(dh==20.0) +
			(-1.6346)*(dh==30.0) +	0.0*(dh==50.0) +
			2.0309*(dh==80.0) + 	3.5181*(dh==100.0) +
			5.0533*(dh==150.0) +	9.9947*(dh==300.0) +	13.0171*(dh==500.0);
	 }

	double y;
	if		(di<10.0)						y=0.0;
	else if ( (di>=10.0) && (di<=50.0) )	y=0.0+(di-10.0)*(p1-0.0)/(50.0-10.0);
	else if ( (di>50.0) && (di<=100.0) )	y=p1;
	else if ( (di>100.0) && (di<200.0) )	y=p1+(di-100.0)*(p2-p1)/(200.0-100.0);
	else if ( di>=200.0 )					y=p2;

	return y;
 }



double CP370_Functions::P370_3(double f,double t,int p,double h1,double d_km,
						 double tetamax15,double h2,int ENV,double *Ebfs) 
{
	double Eb,E0fs  ,HG,c;

	if (h2==10.0)		HG = 0.0;
	else
	{
		if ( (f>=30.0) && (f<=250.0) )			c=4.0*(ENV==1)+5.0*(ENV==2)+6.0*(ENV==3);
		else if ( (f>=450.0) && (f<=1000.0) )	c=4.0*(ENV==1)+6.0*(ENV==2)+8.0*(ENV==3);
  
		HG=(c/6.0)*20.0*log10(h2/10.0);
	}
	Eb=P370_2(f,t,p,h1,d_km,tetamax15,&E0fs);

	Eb=Eb+HG;		*Ebfs=E0fs;
	Eb=min(Eb,E0fs);
	return Eb;
}

double CP370_Functions::P370_2(double f,double t,int p,double h1,double d_km,double tetamax15,double *Ebfs) 
{
	double Eb,E0fs,z;

	if ( (h1>=37.5) && (h1<=1200.0) )		Eb= P370_1(f,t,p,h1,d_km,&E0fs);
	else if ( (h1>=0.0) && (h1<37.5) )
	{
		double dh1=4.1*sqrt(h1);
		if (d_km<dh1)
				Eb=P370_0(f,t,p,37.5,d_km,&E0fs) - P370_0(f,t,p,37.5,dh1,&E0fs) + P370_0(f,t,p,37.5,4.1*sqrt(37.5),&E0fs);
		else	Eb=P370_0(f,t,p,37.5,d_km+4.1*sqrt(37.5)-dh1,&E0fs);
	}
	else if ( (h1>1200.0) )
	{
		double dh1=4.1*sqrt(h1);
		if (d_km<dh1)
				Eb=P370_0(f,t,p,1200.0,d_km,&E0fs) - P370_0(f,t,p,1200.0,dh1,&E0fs) + P370_0(f,t,p,1200,4.1*sqrt(1200.0),&E0fs);
		else	Eb=P370_0(f,t,p,1200.0,d_km+4.1*sqrt(1200.0)-dh1,&E0fs);
	}
	else if ( (h1<0.0) )
		Eb=P370_2(f,t,p,0.0,d_km,tetamax15,&E0fs) + TCAcorr370(tetamax15,f);

	z= P370_1(f,t,p,h1,d_km,&E0fs);
	*Ebfs=E0fs;
	Eb=min(Eb,E0fs);
	return Eb;
}


double CP370_Functions::TCAcorr370(double Tdeg,double f_MHz)
{
	if(Tdeg==-999.999)
		return 0.0;

	double LinDown,LimUP,Corr = 0.0,Tdeginf,Tdegsup,Corrinf,Corrsup;
	if ( (f_MHz>=30.0) && (f_MHz<=250.0) )          // VHF
	{
		LinDown=-32.0;
        LimUP=30.0;
	}
	else if ( (f_MHz>=450.0) && (f_MHz<=1000.0) )    // UHF
	{
		LinDown=-34.0;
        LimUP=40.0;
	}

	
	if (Tdeg<-40.0)								//-------------(Tdeg<-40)------------
		Corr=LinDown;
	
	else if ( (Tdeg>=-40.0) && (Tdeg<-20.0) )	//-------(Tdeg>=-40 , Tdeg<-20)------
	{
		Tdeginf=-40.0;
		Tdegsup=-20.0;
		Corrinf=LinDown;
		Corrsup=zTCAcorr370_0(-20.0,f_MHz);
		Corr=Corrinf + (Tdeg - Tdeginf)*(Corrsup - Corrinf)/(Tdegsup - Tdeginf);
	}
	else if ( (Tdeg>=-20.0) && (Tdeg<0.8) )		//-------(Tdeg>=-20 , Tdeg<=0.8)-------
		Corr=zTCAcorr370_0(Tdeg,f_MHz);
	else if ( (Tdeg>=0.8) && (Tdeg<=1.5) )	    //-------(Tdeg>0.8 , Tdeg<=1.5)--------
	{
		Tdeginf=0.8;
		Tdegsup=1.5;
		Corrinf=zTCAcorr370_0(0.8,f_MHz);
		Corrsup=LimUP;
		Corr=Corrinf + (Tdeg - Tdeginf)*(Corrsup - Corrinf)/(Tdegsup - Tdeginf);
	}
	else if ( Tdeg>1.5 )					//---------------(Tdeg>1.5)-----------------
		Corr=LimUP;

	return Corr;
}

double CP370_Functions::zTCAcorr370_0(double Tdeg,double f_MHz)
{
	// (Tdeg>=-20 & Tdeg<=0.8)
	double pi=4.0*atan(1.0);
	double Trad=Tdeg*pi/180.0;
	double v,Jvp,v01,Corr;

	if ( (f_MHz>=30.0) && (f_MHz<=250.0) )          // VHF
	{
		v=-Trad*sqrt(4000.0*95.0/300.0);
		Jvp=8.1;
	}
	else if ( (f_MHz>=450.0) && (f_MHz<=1000.0) )    // UHF
	{
		v=-Trad*sqrt(4000.0*650.0/300.0);
		Jvp=14.9;
	}
	v01=v-0.1;
	Corr=Jvp-(6.9+20.0*log10(sqrt(1.0+v01*v01)+v01));
	return Corr;
}

double CP370_Functions::P370_1(double f,double t,int p,double h1,double d_km,double *Ebfs) 
{
	double Eb,E0fs;

	if ( (h1==37.5) || (h1==75.0) || (h1==150.0) || (h1==300.0) || (h1==600.0) || (h1==1200.0) )
		Eb= P370_0( f , t , p , h1 , d_km , &E0fs );
	else
	{
		double h11,h12,E1,E2;
		
		if		( (h1 > 37.5) && (h1 < 75.0  ) ) {h11=37.5;h12=75.0;  }
		else if ( (h1 > 75.0  ) && (h1 < 150.0 ) ) {h11=75.0  ;h12=150.0; }
		else if ( (h1 > 150.0 ) && (h1 < 300.0 ) ) {h11=150.0 ;h12=300.0; }
		else if ( (h1 > 300.0 ) && (h1 < 600.0 ) ) {h11=300.0 ;h12=600.0; }
		else if ( (h1 > 600.0 ) && (h1 < 1200.0) ) {h11=600.0 ;h12=1200.0;}
		E1=P370_0( f , t , p , h11 , d_km , &E0fs );
		E2=P370_0( f , t , p , h12 , d_km , &E0fs );
		Eb=E1+(E2-E1)*log10(h1/h11)/log10(h12/h11);
	}
	*Ebfs=E0fs;
	return Eb;
}



double CP370_Functions::P370_0(double f,double t,int p,double h1,double d_km,double *Ebfs) 
{
	//p=1=='Land'  p=2=='Cold Sea' p=3=='Warm Sea'
	//	double h0[]		=	{37.5,75,150,300,600,1200};
	double D0[]		=	{10.0,15.0,20.0,25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.0,150.0,200.0,250.0,300.0,350.0,400.0,450.0,500.0,550.0,600.0,650.0,700.0,750.0,800.0,850.0,900.0,950.0,1000.0};
	double E037[32],E075[32],E0150[32],E0300[32],E0600[32],E01200[32],E0fs[32];	
	
	if ( (f>=30.0) && (f<=250.0) )
	{
		if		( (t==50) && (p==1) ) 				F370_1A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )				F370_2A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5 ) && (p==1) )				F370_3A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==1) )				F370_4A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))	F370_1B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )				F370_2B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5 ) && (p==2) )				F370_3B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==2) )				F370_4B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )				F370_2C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5 ) && (p==3) )				F370_3C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==3) )				F370_4C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}
	else if ( (f>=450.0) && (f<=1000.0) )
	{
		if		( (t==50) && (p==1) )				F370_9(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )				F370_10(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==1) )				F370_11(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))	F370_13(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )				F370_14A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5 ) && (p==2) )				F370_15A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==2) )				F370_16A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )				F370_14B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5 ) && (p==3) )				F370_15B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1 ) && (p==3) )				F370_16B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}

	double E0[32];
	int i;

	if(h1==37.5)
		for (i=0;i<32;i++)		E0[i]=E037[i];
	else if(h1==75.0)
		for (i=0;i<32;i++)		E0[i]=E075[i];
	else if(h1==150.0)
		for (i=0;i<32;i++)		E0[i]=E0150[i];
	else if(h1==300.0)
		for (i=0;i<32;i++)		E0[i]=E0300[i];
	else if(h1==600.0)
		for (i=0;i<32;i++)		E0[i]=E0600[i];
	else if(h1==1200.0)
		for (i=0;i<32;i++)		E0[i]=E01200[i];

	*Ebfs=Interp1(D0,E0fs, d_km,32);
	double  Eb=Interp1(D0,E0, d_km,32);
	Eb=min(Eb,*Ebfs);
	return Eb;
}


double CP370_Functions::Interp1(double *D0,double *E0,double d,int num) 
{
	double d1,d2,E1,E2,Eb;
	if (d<D0[0])
	{
		d1=D0[0];d2=D0[1];
		E1=E0[0];E2=E0[1];
	}
	else if (d>D0[num-1])
	{
		d1=D0[num-2];d2=D0[num-1];
		E1=E0[num-2];E2=E0[num-1];
	}
	else
	{
		/////////////////////////////////////////////
		int n1=0;
		while(d>=D0[n1])
		{
			n1++;
			if (n1==num)
				break;
		}
		if (n1==0)
			n1=1;
		d1=D0[n1-1];E1=E0[n1-1];
		///////////////////////////////////////////////
		int n2=num-1;
		while(d<=D0[n2])
			n2--;
		d2=D0[n2+1];E2=E0[n2+1];
		////////////////////////////////////////////////
	}
	Eb=((d1==d2) ? E1 : E1+(E2-E1)*log10(d/d1)/log10(d2/d1));

	return Eb;

}

double CP370_Functions::Interp2(double *D0,double *E0,double d,int num) 
{
	double d1,d2,E1,E2,Eb;
	if (d<D0[0])
	{
		d1=D0[0];d2=D0[1];
		E1=E0[0];E2=E0[1];
	}
	else if (d>D0[num-1])
	{
		d1=D0[num-2];d2=D0[num-1];
		E1=E0[num-2];E2=E0[num-1];
	}
	else
	{
		/////////////////////////////////////////////
		int n1=0;
		while(d>=D0[n1])
		{
			n1++;
			if (n1==num)
				break;
		}
		if (n1==0)
			n1=1;
		d1=D0[n1-1];E1=E0[n1-1];
		///////////////////////////////////////////////
		int n2=num-1;
		while(d<=D0[n2])
			n2--;
		d2=D0[n2+1];E2=E0[n2+1];
		////////////////////////////////////////////////
	}
	Eb=((d1==d2) ? E1 : E1+(E2-E1)*(d-d1)/(d2-d1));

	return Eb;

}



void CP370_Functions::F370_1A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{63.28,56.44,51.18,46.44,42.36,38.55,35.65,32.63,30.26,26.44,22.89,20.13,17.36,15.39,6.97,1.18,-4.21,-9.07,-13.81,-18.15,-22.23,-26.18,-30.52,-34.47,-38.55,-42.5,-46.44,-50.52,-54.35,-57.97,-61.38,-64.62};
	double aE075[]	=	{70.65,62.76,56.97,51.71,47.76,44.34,41.57,38.68,36.18,31.84,28.02,25.13,22.1,19.86,9.47,2.63,-2.89,-8.02,-12.5,-16.97,-21.18,-25.26,-29.21,-33.68,-37.5,-41.44,-45.65,-49.73,-53.56,-57.18,-60.59,-63.83};
	double aE0150[]	=	{77.23,69.86,64.34,59.47,55.39,51.57,48.68,45.52,42.89,38.42,34.47,31.05,27.36,24.34,12.1,4.73,-1.44,-6.57,-11.31,-15.65,-19.73,-23.68,-28.02,-32.1,-36.31,-40.39,-44.47,-48.42,-52.12,-55.62,-58.93,-62.06};
	double aE0300[]	=	{83.42,76.71,71.44,66.71,63.02,59.47,56.44,53.42,50.52,45.78,41.05,37.1,33.02,30,16.57,8.02,1.18,-4.47,-9.47,-13.94,-18.02,-22.1,-26.31,-30.52,-34.47,-38.42,-42.36,-46.57,-50.53,-54.26,-57.79,-61.13};
	double aE0600[]	=	{86.84,81.97,77.76,73.81,70.13,66.71,63.94,61.18,58.55,54.21,49.73,45.92,41.71,38.55,24.34,14.07,5.78,-0.26,-5.65,-10.65,-15.26,-19.21,-23.42,-27.63,-31.57,-35.52,-39.73,-43.94,-48.15,-52.12,-55.88,-59.44};
	double aE01200[]=	{86.84,83.68,81.05,78.81,76.84,75,73.02,70.65,68.42,64.07,59.86,56.18,51.97,48.68,32.89,20.39,11.05,3.81,-2.1,-7.23,-11.84,-15.92,-20.26,-24.47,-28.68,-32.36,-36.57,-40.52,-44.73,-48.68,-52.41,-55.96};
*/
	double aE037[]	=	{63.80,56.10,50.20,45.50,41.60,38.10,35.00,32.30,30.00,26.00,22.60,20.00,17.60,15.00,7.00,1.00,-4.50,-9.40,-14.10,-18.10,-22.30,-26.50,-30.60,-34.60,-38.70,-42.90,-47.00,-51.10,-55.20,-59.30,-63.70,-68.00};
	double aE075[]	=	{70.70,62.20,56.20,51.20,47.10,43.90,40.80,38.40,36.00,31.40,27.70,24.20,21.50,18.70,9.20,2.10,-3.40,-8.20,-13.20,-17.40,-21.60,-25.70,-29.80,-33.80,-38.00,-42.10,-46.20,-50.30,-54.40,-58.40,-62.60,-66.80};
	double aE0150[]	=	{77.80,69.10,63.20,58.30,54.30,51.20,48.20,45.10,43.10,37.70,33.70,30.00,26.70,23.40,11.70,3.70,-1.60,-6.90,-11.50,-16.10,-20.20,-24.30,-28.30,-32.30,-36.50,-40.70,-44.80,-48.80,-52.90,-56.90,-61.10,-65.20};
	double aE0300[]	=	{84.50,76.10,70.80,66.20,62.20,59.00,55.80,52.70,50.20,45.00,40.80,36.30,32.70,28.80,15.20,6.60,0.70,-4.90,-9.60,-14.00,-18.30,-22.50,-26.60,-30.70,-34.80,-39.10,-43.20,-47.20,-51.30,-55.30,-59.40,-63.50};
	double aE0600[]	=	{87.00,81.60,77.30,73.10,69.50,66.30,63.40,60.60,58.30,53.70,49.40,45.00,41.30,37.20,22.00,11.30,4.60,-1.30,-6.90,-11.50,-15.70,-19.90,-24.10,-28.20,-32.30,-36.40,-40.10,-44.60,-48.70,-52.70,-56.90,-61.10};
	double aE01200[]=	{87.00,83.40,80.90,78.30,76.20,74.00,71.90,70.00,67.90,63.80,59.80,55.70,51.90,48.00,31.70,19.40,10.60,3.00,-2.60,-7.50,-12.00,-16.50,-20.60,-24.70,-29.00,-33.20,-37.30,-41.30,-45.40,-49.40,-53.70,-58.00};

	double aE0fs[]	=	{86.84,83.68,81.05,78.81,77.36,75.92,74.86,73.94,72.89,71.18,70,68.94,67.76,66.97,63.42,61.05,58.94,57.36,56.18,55.13,54.07,53.28,52.36,51.71,50.78,50.13,49.34,48.55,48.02,47.5,46.97,46.44};

	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_2A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{63.98,56.45,50.77,46.15,42.59,39.55,37.3,35.19,33.61,31.36,29.38,27.66,26.08,24.36,17.5,11.16,5.35,-0.19,-5.21,-9.96,-14.72,-19.34,-23.57,-27.92,-32.28,-36.51,-40.73,-45.09,-49.32,-53.3,-57.07,-60.65};
	double aE075[]	=	{70.32,62.39,56.85,52.09,48.26,44.83,42.32,39.94,37.96,34.93,32.42,30.3,28.59,26.48,19.34,13.01,6.93,1.38,-3.89,-8.77,-13.53,-18.02,-22.24,-26.73,-30.96,-35.19,-39.54,-43.9,-48.13,-52.11,-55.88,-59.46};
	double aE0150[]	=	{78.24,69.53,63.72,58.83,55,51.3,48.53,45.76,43.51,39.94,36.78,34.4,32.29,29.78,21.72,15.12,8.91,3.23,-2.17,-7.32,-12.21,-16.7,-20.92,-25.41,-29.64,-33.6,-38.09,-42.58,-47.07,-51.3,-55.31,-59.11};
	double aE0300[]	=	{85.37,77.45,71.64,66.75,62.66,58.96,56.06,53.28,50.77,46.55,42.85,39.81,37.3,34.4,25.55,18.16,11.68,5.48,-0.06,-5.21,-10.1,-14.85,-19.21,-23.83,-28.06,-32.15,-36.77,-41.26,-45.62,-49.73,-53.61,-57.3};
	double aE0600[]	=	{86.83,83.66,79.03,74.28,70.58,66.75,63.72,60.68,58.04,53.81,49.85,46.15,42.98,39.28,29.78,21.85,14.85,8.78,2.97,-2.3,-7.19,-11.94,-16.43,-21.19,-25.41,-29.38,-33.87,-38.36,-42.85,-47.34,-51.58,-55.61};
	double aE01200[]=	{86.83,84.05,81.41,78.9,76.66,74.41,72.43,69.79,67.68,63.85,60.15,56.58,53.41,49.59,37.7,28.59,20,13.53,7.59,2.18,-3.1,-7.98,-12.21,-17.09,-21.58,-25.68,-29.9,-34.26,-38.62,-43.11,-47.34,-51.34};
*/
	double aE037[]	=	{63.80,56.40,50.70,46.60,42.90,39.80,37.20,35.00,33.40,31.20,29.20,27.50,26.00,24.40,17.80,11.50,5.70,0.30,-4.80,-9.80,-14.30,-18.70,-23.20,-27.70,-32.10,-36.40,-40.80,-45.10,-49.50,-53.80,-57.90,-61.90};
	double aE075[]	=	{71.00,62.60,57.00,52.20,48.10,45.00,42.50,40.00,38.30,35.30,32.80,30.50,28.40,26.70,19.70,13.00,7.50,1.70,-3.60,-8.70,-13.30,-17.80,-22.10,-26.40,-30.90,-35.30,-39.60,-43.90,-48.30,-52.70,-56.90,-61.00};
	double aE0150[]	=	{78.00,69.70,63.60,58.60,54.80,51.40,48.20,45.90,43.60,40.00,37.10,34.40,32.50,30.60,21.80,14.80,8.80,3.10,-2.40,-7.50,-12.10,-16.60,-21.00,-25.30,-29.70,-34.00,-38.40,-42.80,-47.30,-51.80,-56.20,-60.60};
	double aE0300[]	=	{84.50,77.10,71.20,66.60,62.60,59.20,56.20,53.80,51.20,47.10,43.30,40.00,37.40,34.80,25.30,17.70,11.30,5.00,-0.40,-5.60,-10.30,-14.90,-19.20,-23.50,-27.90,-32.30,-36.70,-41.10,-45.60,-50.00,-54.40,-58.70};
	double aE0600[]	=	{87.00,82.30,78.30,74.00,70.10,66.80,63.50,60.60,58.30,53.70,49.70,46.20,43.30,40.10,29.60,21.40,14.90,8.50,3.10,-2.20,-7.10,-12.00,-16.40,-20.70,-25.10,-29.50,-33.90,-38.20,-42.70,-47.10,-51.50,-55.80};
	double aE01200[]=	{87.00,83.40,80.90,78.50,76.30,74.20,72.10,70.00,67.90,63.80,60.00,56.20,53.10,49.50,36.50,27.30,20.30,13.50,7.70,2.10,-2.90,-7.80,-12.50,-17.10,-21.50,-25.80,-30.20,-34.60,-39.10,-43.50,-47.90,-52.30};
	
	double aE0fs[]	=	{86.83,84.18,81.41,79.56,77.85,76.26,75.2,74.02,73.22,71.51,70.05,68.87,67.94,66.75,63.45,61.21,58.96,57.38,56.32,55,54.08,53.15,52.36,51.57,50.77,49.98,49.32,48.66,47.87,47.34,46.81,46.55};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_3A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{64.11,56.19,51.3,47.47,44.3,41.93,40.08,38.49,36.91,34.79,32.68,30.7,28.98,27.4,20.66,15.12,10.1,4.69,-0.19,-4.55,-9.3,-13.66,-18.02,-22.24,-26.47,-30.96,-35.19,-39.41,-43.11,-46.81,-50.31,-53.62};
	double aE075[]	=	{70.98,62.92,57.24,52.89,49.45,46.81,44.83,42.98,41.27,38.49,35.85,33.47,31.63,29.78,22.91,17.5,12.21,6.67,1.91,-2.7,-7.19,-11.94,-16.43,-20.92,-25.15,-29.38,-33.6,-37.56,-41.53,-45.22,-48.66,-51.91};
	double aE0150[]	=	{78.24,69.79,63.98,59.62,55.92,52.89,50.51,48.4,46.42,43.11,40.08,37.04,34.66,32.55,25.15,20,14.59,9.04,3.89,-0.72,-5.34,-10.1,-14.59,-19.34,-23.57,-27.53,-31.75,-35.98,-39.94,-43.64,-46.94,-50};
	double aE0300[]	=	{84.05,76.92,71.37,66.62,62.66,59.36,56.58,54.21,51.83,48.13,45.1,42.19,39.94,37.7,29.38,23.31,17.63,11.16,6.01,1.38,-3.36,-7.98,-12.74,-17.23,-21.45,-25.68,-29.64,-33.87,-38.09,-41.79,-44.96,-47.6};
	double aE0600[]	=	{86.96,83.13,79.03,74.81,70.85,67.41,64.77,62.13,59.49,55.26,51.43,48.13,45.62,43.11,33.74,26.87,20.93,14.59,9.04,4.16,-0.98,-5.87,-10.62,-15.11,-19.47,-23.57,-27.92,-31.75,-35.85,-39.68,-43.11,-45.49};
	double aE01200[]=	{86.96,84.45,82.07,79.43,77.05,74.54,72.17,70.05,67.94,64.24,60.68,57.24,54.21,51.04,39.81,30.7,24.1,17.63,11.95,6.8,1.78,-3.23,-8.11,-12.74,-17.23,-21.32,-25.41,-29.38,-33.21,-37.04,-40.2,-42.85};
	double aE0fs[]	=	{86.96,84.45,82.2,80.09,78.24,76.66,75.34,74.15,72.96,71.24,69.92,68.47,67.28,66.36,63.72,61.73,60.02,58.17,56.58,55.26,53.94,52.89,52.09,51.17,50.51,49.85,49.32,48.92,48.53,48.26,47.87,47.6};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_4A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{63.76,56.51,51.77,48.08,45.18,42.94,41.22,39.64,38.06,35.69,33.84,32.52,31.2,29.89,24.35,19.34,14.6,9.59,4.84,0.62,-3.85,-8.33,-12.81,-17.16,-21.78,-26.26,-30.87,-35.49,-39.97,-44.32,-48.93,-53.3};
	double aE075[]	=	{70.75,62.71,57.44,53.61,50.58,48.21,46.23,44.65,43.07,40.43,38.06,36.21,34.63,32.92,26.06,20.92,16.18,11.17,6.42,1.94,-2.53,-7.01,-11.5,-16.24,-20.59,-25.2,-29.69,-34.17,-38.65,-42.87,-47.48,-51.85};
	double aE0150[]	=	{77.21,69.04,63.24,59.15,55.59,52.82,50.85,49,47.29,44.25,41.62,39.51,37.66,35.69,28.44,22.9,17.89,12.62,7.74,3.39,-1.21,-5.96,-10.44,-14.92,-19.27,-23.89,-28.37,-33.11,-37.6,-41.81,-46.56,-51.06};
	double aE0300[]	=	{83.67,76.15,70.62,66.4,62.45,59.28,56.78,54.54,52.43,48.47,45.44,42.94,40.83,38.45,30.81,24.88,19.6,14.2,9.32,4.71,0.1,-4.64,-9.12,-13.6,-18.09,-22.44,-26.79,-31.27,-35.75,-39.97,-44.71,-48.54};
	double aE0600[]	=	{86.83,81.56,77.34,73.65,70.09,66.93,64.55,62.45,60.07,55.85,51.9,49,46.36,43.73,34.76,28.44,22.9,17.23,12.09,7.48,3,-1.74,-6.49,-10.97,-15.45,-19.8,-24.15,-28.63,-33.11,-37.33,-41.81,-46.3};
	double aE01200[]=	{86.83,83.4,80.64,78.4,76.02,73.91,72.33,70.62,68.9,65.35,61.92,59.15,56.51,53.75,42.15,33.97,27.65,21.32,15.91,11.17,6.42,1.68,-2.93,-7.28,-11.76,-16.24,-20.46,-24.94,-29.42,-33.64,-38.39,-42.47};
*/
	double aE037[]	=	{64.20,57.30,52.30,48.20,45.70,43.10,41.10,39.80,38.10,36.00,34.00,32.60,31.30,30.00,24.30,19.30,14.90,10.00,5.30,0.60,-3.90,-8.30,-13.00,-17.60,-22.30,-26.90,-31.40,-35.90,-40.30,-44.70,-49.30,-53.90};
	double aE075[]	=	{71.10,63.10,57.50,53.60,50.60,48.10,46.60,45.00,43.30,40.80,38.20,36.80,35.00,33.60,26.30,20.80,16.00,11.10,6.40,1.60,-2.90,-7.30,-11.90,-16.40,-20.90,-25.40,-30.10,-34.70,-39.10,-43.50,-48.20,-52.90};
	double aE0150[]	=	{78.00,69.80,63.60,59.40,56.10,53.50,51.00,49.00,47.20,43.90,41.70,39.00,37.30,35.30,27.80,22.20,17.30,12.40,7.80,2.70,-1.70,-6.00,-10.70,-15.30,-19.80,-24.30,-28.80,-33.30,-37.70,-42.10,-46.80,-51.40};
	double aE0300[]	=	{84.50,77.10,71.20,66.70,62.90,59.50,56.90,54.70,52.50,48.50,45.60,43.10,40.60,38.30,30.30,24.30,19.30,14.30,9.30,4.60,0.20,-4.30,-8.90,-13.40,-17.90,-22.40,-27.20,-31.90,-36.10,-40.30,-44.60,-48.90};
	double aE0600[]	=	{87.00,82.30,78.30,74.00,70.10,67.10,64.60,62.30,60.00,55.80,52.40,49.30,47.20,44.30,34.80,28.00,22.60,17.40,12.50,7.60,3.10,-1.40,-6.00,-10.50,-15.20,-19.80,-24.10,-28.30,-32.90,-37.40,-41.70,-45.90};
	double aE01200[]=	{87.00,83.40,80.90,78.50,76.40,74.30,72.60,70.50,69.00,65.20,62.30,58.70,56.30,53.60,42.10,33.80,27.60,21.90,16.30,11.40,6.70,2.00,-2.50,-6.90,-11.40,-15.90,-20.40,-24.90,-29.20,-33.50,-38.00,-42.40};  

	double aE0fs[]	=	{86.83,83.4,81.03,79.05,77.6,76.15,74.97,74.05,73.12,71.28,69.96,68.77,67.85,66.8,63.24,61.13,59.02,57.17,55.72,54.54,53.75,52.95,52.16,51.37,50.85,50.05,49.53,49,48.74,48.21,47.81,47.42};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_1B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{62.87,56.39,51.63,47.98,45.01,42.52,40.38,38.14,36.15,32.71,29.4,26.23,23.58,21.2,10.48,3.87,-1.81,-6.84,-11.34,-15.83,-19.8,-23.77,-28.01,-31.97,-36.21,-40.44,-44.41,-48.64,-52.62,-56.37,-59.92,-63.28};
	double aE075[]	=	{68.43,61.55,56.66,53.01,50.04,47.69,45.67,43.43,41.44,38,34.83,31.65,28.48,25.3,12.73,5.46,-0.36,-5.38,-10.01,-14.25,-18.48,-22.45,-26.55,-30.65,-34.89,-38.99,-43.09,-47.32,-51.3,-55.05,-58.59,-61.96};
	double aE0150[]	=	{76.63,70.02,64.99,61.13,57.98,55.35,53.08,50.63,48.45,44.88,41.18,37.47,33.77,30.33,15.64,7.31,1.09,-4.06,-8.69,-12.92,-17.16,-20.99,-25.1,-29.33,-33.56,-37.8,-41.77,-46,-50,-53.76,-57.33,-60.71};
	double aE0300[]	=	{84.31,77.69,72.53,68.74,65.65,63.09,60.89,58.16,55.73,51.5,47.13,42.63,38.8,35.09,19.08,10.35,3.74,-1.68,-6.31,-10.67,-15.04,-19.01,-22.98,-27.21,-31.45,-35.68,-39.78,-43.88,-48.12,-52.11,-55.88,-59.46};
	double aE0600[]	=	{86.95,81.66,77.29,73.87,71.08,68.73,66.71,64.61,62.74,59.17,55.2,51.1,47.66,44.48,26.23,14.85,7.31,1.62,-3.53,-8.03,-12.39,-16.36,-20.33,-24.57,-28.8,-32.9,-37,-41.24,-45.47,-49.44,-53.19,-56.75};
	double aE01200[]=	{86.95,84.17,81.4,78.85,76.77,74.92,73.33,71.51,69.89,67.11,64.2,61.29,58.51,55.6,34.96,21.2,11.67,5.19,-0.09,-4.99,-9.48,-13.45,-17.69,-21.66,-26.02,-30.39,-34.62,-38.59,-42.82,-46.79,-50.55,-54.11};
	double aE0fs[]	=	{86.95,84.17,81.4,79.35,77.69,76.34,75.18,74.06,73.06,71.34,70.02,68.56,67.77,66.97,63.8,61.55,59.57,57.71,55.99,54.67,53.08,52.03,50.97,50.17,49.51,48.59,48.19,47.79,47.53,47.26,47,47.13};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_2B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{62.79,56.79,52.55,49.27,46.6,44.47,42.63,41.23,39.99,37.47,35.49,33.37,31.78,29.8,20.41,13.13,7.44,1.49,-3.4,-7.37,-11.87,-16.1,-20.46,-24.7,-29.06,-33.3,-37.53,-41.77,-46,-49.99,-53.77,-57.35};
	double aE075[]	=	{68.34,62.08,57.45,53.95,51.1,48.97,47.13,45.59,44.22,41.31,39.32,37.08,35.22,32.84,22.92,15.51,9.29,3.34,-1.55,-5.78,-10.15,-14.51,-18.75,-23.11,-27.48,-31.71,-35.94,-40.44,-44.54,-48.64,-52.52,-56.2};
	double aE0150[]	=	{75.34,68.96,64.33,60.83,57.98,55.56,53.48,51.59,49.91,46.73,44.09,41.18,38.53,36.15,25.57,17.89,11.54,5.32,0.16,-4.46,-8.95,-13.19,-17.42,-21.66,-26.15,-30.39,-34.62,-38.85,-43.09,-47.19,-51.07,-54.75};
	double aE0300[]	=	{82.07,76.5,72,68.36,65.39,62.69,60.36,58.12,56.13,52.29,49.11,45.94,43.03,39.99,28.21,20.01,13.53,7.44,2.02,-2.6,-7.37,-11.6,-16.1,-20.6,-24.83,-29.06,-33.56,-37.8,-42.03,-46,-49.75,-53.31};
	double aE0600[]	=	{86.43,81,76.77,73.41,70.68,67.98,65.65,63.34,61.29,57.58,54.54,51.5,48.72,45.54,32.31,23.32,16.83,10.22,4.93,0.16,-4.72,-9.48,-14.11,-18.61,-22.98,-27.21,-31.58,-35.94,-40.18,-44.15,-48.51,-52.65};
	double aE01200[]=	{86.43,83.38,80.73,78.47,76.63,74.71,73.06,71.17,69.49,66.05,63.14,59.96,57.32,54.54,41.97,30.2,22.13,15.25,9.69,4.66,-0.22,-5.38,-10.28,-15.04,-19.54,-24.04,-28.27,-32.5,-36.74,-40.97,-45.2,-48.91};
	
	double aE0fs[]	=	{86.43,83.38,80.73,78.83,77.29,75.94,74.78,73.8,72.93,71.08,69.89,68.56,67.5,66.45,63.14,60.89,58.77,57.05,55.6,54.41,53.35,52.16,51.5,50.7,49.91,49.38,48.85,48.32,48.06,47.79,47.39,47.26};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_3B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{63.45,58.04,54.08,51.16,48.79,46.81,45.1,43.56,42.19,39.81,37.96,36.38,34.93,33.21,25.68,19.87,14.06,9.18,4.16,-0.32,-4.81,-9.3,-13.53,-17.75,-21.45,-25.15,-28.58,-31.62,-34.92,-38.09,-41,-43.9};
	double aE075[]	=	{69.13,63.32,58.83,55.92,53.55,51.56,49.85,48.17,46.68,44.17,41.93,39.94,38.1,35.98,28.19,21.59,15.38,10.63,5.61,0.99,-3.49,-7.98,-12.21,-16.43,-20.13,-23.83,-27.26,-30.43,-33.87,-37.04,-40.07,-42.85};
	double aE0150[]	=	{76.39,70.85,66.22,62.58,59.62,57.07,54.87,52.91,51.17,47.87,45.23,42.98,41,39.02,30.44,23.31,16.97,11.95,7.06,2.57,-2.17,-6.66,-10.89,-15.11,-19.08,-22.51,-25.94,-29.24,-32.81,-35.98,-39.02,-41.92};
	double aE0300[]	=	{82.34,77.58,73.09,69.09,65.83,63,60.55,58.38,56.45,52.89,49.98,47.34,44.96,42.45,32.29,25.42,18.82,13.67,8.65,3.89,-0.59,-5.08,-9.3,-13.53,-17.49,-21.19,-24.62,-28.06,-31.49,-34.92,-37.83,-40.86};
	double aE0600[]	=	{86.83,82.07,77.58,73.87,70.85,68.16,65.83,63.8,62,58.43,55.66,53.15,50.77,47.74,37.17,30.04,22.51,17.1,11.95,7.06,2.44,-2.17,-6.4,-10.36,-14.59,-18.55,-22.24,-25.68,-29.38,-32.68,-35.58,-38.49};
	double aE01200[]=	{86.83,83.79,81.02,78.62,76.66,74.74,73.09,71.41,69.92,66.88,63.98,61.21,58.7,55.79,43.91,35.59,27.66,21.46,15.78,10.89,6.01,1.52,-2.96,-7.32,-11.42,-15.38,-19.34,-22.77,-26.47,-29.9,-33.07,-36.11};
	double aE0fs[]	=	{86.96,83.79,81.02,79.12,77.58,76.16,74.94,73.82,72.83,71.11,69.79,68.73,67.55,66.62,63.32,61.07,59.09,57.24,55.79,54.47,53.41,52.62,51.57,50.77,50.25,49.59,49.06,48.66,48.13,47.87,47.6,47.34};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_4B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{64.11,60.15,57.24,54.87,53.02,51.43,49.85,48.79,47.74,45.76,44.04,42.72,41.4,40.08,34.79,30.57,26.08,21.59,16.83,12.61,8.91,5.48,2.04,-0.72,-3.49,-6,-8.38,-10.62,-12.87,-15.11,-17.36,-19.08};
	double aE075[]	=	{70.71,65.43,62,59.36,56.98,55.13,53.41,52.23,50.91,48.53,46.68,45.1,43.51,42.19,36.64,32.42,27.8,22.91,18.42,14.19,10.23,6.53,3.1,0.46,-2.44,-5.08,-7.45,-9.7,-12.08,-14.32,-16.43,-18.55};
	double aE0150[]	=	{77.98,71.77,67.81,64.64,61.73,59.36,57.38,56.06,54.6,51.7,49.32,47.6,46.02,44.57,38.76,34.13,29.25,24.49,20,15.51,11.55,7.59,4.16,1.25,-1.51,-4.02,-6.66,-9.04,-11.42,-13.66,-15.64,-17.75};
	double aE0300[]	=	{83.26,77.32,72.7,69,65.7,63.19,60.94,59.62,57.77,55,52.49,50.51,48.92,47.08,40.21,35.59,30.83,26.08,21.59,17.1,13.27,9.44,5.74,2.84,-0.06,-2.83,-5.47,-7.85,-10.23,-12.6,-14.72,-16.57};
	double aE0600[]	=	{86.96,83.13,79.03,74.41,70.85,68.07,65.7,64.11,62.53,59.62,56.98,54.87,53.02,51.17,44.3,39.55,34.53,29.64,24.89,20.14,15.78,11.82,7.85,4.95,1.78,-1.12,-3.76,-6.27,-8.77,-11.02,-13.4,-15.11};
	double aE01200[]=	{86.96,83.39,80.49,78.11,76,74.15,72.3,70.98,69.39,66.49,63.85,61.6,59.62,57.64,49.85,44.3,38.76,33.61,28.46,23.57,19.21,14.99,10.5,7.33,4.16,1.25,-1.64,-4.28,-6.93,-9.43,-11.81,-13.92};
*/
	double aE037[]	=	{64.50,60.00,57.10,55.10,53.20,51.70,50.00,48.90,47.90,45.80,44.20,42.80,41.40,40.00,35.00,30.70,26.20,21.90,17.30,12.90,9.10,5.30,2.30,-0.70,-3.30,-5.90,-8.20,-10.50,-12.70,-14.90,-16.70,-18.40};
	double aE075[]	=	{71.10,65.50,62.00,59.30,57.10,55.50,53.60,52.30,50.90,48.40,47.00,45.00,43.80,42.30,37.00,32.30,27.60,23.00,18.60,14.40,10.70,6.90,3.70,0.50,-2.40,-5.20,-7.60,-9.90,-12.30,-14.60,-16.30,-17.90};
	double aE0150[]	=	{78.00,71.90,67.50,64.00,61.20,59.00,57.30,55.50,54.40,52.00,49.40,47.50,45.80,44.40,38.00,33.40,28.60,24.20,19.60,15.20,11.50,7.80,4.70,1.50,-1.40,-4.20,-6.60,-9.00,-11.20,-13.40,-15.20,-16.90};
	double aE0300[]	=	{84.50,77.50,72.90,68.90,65.60,63.20,61.00,59.60,57.90,55.00,52.80,50.40,48.80,47.10,40.20,35.00,30.60,26.00,21.60,17.20,13.20,9.20,5.90,2.50,-0.20,-2.90,-5.40,-7.80,-10.30,-12.70,-14.60,-16.40};
	double aE0600[]	=	{87.00,82.30,78.30,74.50,70.80,68.10,65.60,64.30,62.50,59.40,57.00,54.80,53.40,51.20,44.80,39.60,34.80,29.80,24.60,20.00,16.00,12.00,8.30,4.50,1.40,-1.70,-4.00,-6.30,-8.70,-11.10,-13.30,-15.40};
	double aE01200[]=	{87.00,83.40,80.90,78.50,76.40,74.30,72.60,70.50,69.40,66.40,64.20,61.80,59.80,57.90,50.00,44.40,39.20,34.10,28.30,23.50,19.30,15.00,11.30,7.50,4.60,1.70,-1.50,-4.60,-7.10,-9.60,-11.80,-13.90};  

	double aE0fs[]	=	{86.96,83.39,81.15,79.3,77.58,76.26,74.81,74.15,73.09,71.24,69.79,68.6,67.55,66.62,63.58,61.34,59.23,57.64,56.19,55,54.08,53.15,52.36,51.7,51.04,50.25,49.72,49.19,48.66,48.13,47.6,47.34};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_2C(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{63.06,56.45,51.96,49.05,46.68,44.55,42.72,41.18,39.81,37.17,35.32,33.21,31.63,29.78,21.99,16.57,11.29,7.06,3.36,0.06,-2.96,-5.87,-8.64,-11.15,-13.79,-16.17,-18.55,-20.53,-22.64,-24.36,-26.07,-27.39};
	double aE075[]	=	{70.32,63.72,58.83,55.26,52.36,49.95,47.87,46.12,44.57,42.19,40.08,37.83,35.59,33.47,24.36,18.42,13.27,8.91,5.21,1.78,-1.38,-4.28,-7.19,-9.7,-12.34,-14.85,-17.23,-19.34,-21.45,-23.3,-25.02,-26.47};
	double aE0150[]	=	{77.45,70.19,64.64,60.71,57.51,55.03,52.89,50.93,49.19,46.15,43.64,41.13,38.89,36.51,27.27,20.66,15.25,10.76,6.8,3.1,-0.19,-3.36,-6.13,-8.91,-11.55,-13.79,-16.17,-18.41,-20.53,-22.38,-24.09,-25.55};
	double aE0300[]	=	{83.79,77.58,72.7,68.91,65.83,63.2,60.94,58.78,56.85,53.15,49.98,46.68,43.77,40.87,29.91,23.31,17.5,12.61,8.38,4.42,0.99,-2.17,-5.08,-7.85,-10.49,-13.13,-15.38,-17.49,-19.74,-21.58,-23.3,-24.75};
	double aE0600[]	=	{86.96,82.47,78.37,75.17,72.56,70.01,67.81,65.78,63.98,60.28,57.11,53.55,50.38,47.47,35.85,27.66,21.19,15.65,11.02,6.8,3.36,-0.06,-3.23,-6.4,-9.17,-11.68,-13.92,-16.17,-18.28,-20.4,-22.11,-23.57};
	double aE01200[]=	{86.96,83.79,81.28,79.17,77.45,75.75,74.28,72.6,71.11,67.94,65.17,62.13,59.62,56.58,42.32,32.42,25.15,19.48,14.46,10.23,6.27,2.84,-0.32,-3.49,-6.27,-8.91,-11.42,-13.79,-16.3,-18.68,-20.79,-22.38};
*/
	double aE037[]	=	{63.80,57.30,52.40,49.20,46.40,44.20,42.40,41.10,40.40,38.20,36.20,34.50,33.00,31.40,22.80,15.90,11.60,7.40,3.60,0.00,-2.80,-5.60,-8.40,-11.10,-13.40,-15.70,-17.80,-19.90,-22.00,-24.00,-25.90,-27.70};
	double aE075[]	=	{71.00,63.50,58.80,54.80,51.60,49.40,47.80,46.10,45.30,42.30,39.80,37.50,35.40,33.70,24.70,18.00,13.40,9.10,5.10,1.40,-1.60,-4.50,-7.20,-9.90,-12.30,-14.70,-16.60,-18.50,-20.60,-22.60,-24.60,-26.50};
	double aE0150[]	=	{78.00,70.60,65.30,61.20,58.30,55.80,53.40,52.00,50.60,47.00,44.10,41.40,39.50,37.60,26.80,21.60,16.20,11.10,6.80,2.90,-0.20,-3.30,-6.00,-8.70,-11.10,-13.50,-15.70,-17.80,-19.80,-21.80,-23.60,-25.30};
	double aE0300[]	=	{84.50,78.00,72.90,69.20,66.10,63.60,61.40,59.90,58.20,54.10,50.30,47.00,44.40,41.80,30.30,24.50,18.80,13.30,8.90,4.80,1.50,-1.90,-4.70,-7.40,-9.90,-12.30,-14.60,-16.90,-18.70,-20.50,-22.50,-24.40};
	double aE0600[]	=	{87.00,82.30,78.30,74.80,72.00,69.50,67.50,65.90,64.60,60.70,56.70,53.20,50.30,47.10,34.60,28.30,21.80,15.60,11.20,7.00,3.50,0.00,-2.90,-5.70,-8.30,-10.80,-13.00,-15.20,-17.40,-19.50,-21.30,-23.00};
	double aE01200[]=	{87.00,83.40,80.90,79.00,77.20,75.50,73.70,72.10,70.60,67.90,65.50,63.20,60.10,56.50,41.50,34.60,27.00,19.70,14.70,10.00,6.30,2.60,-0.30,-3.20,-6.20,-9.10,-11.40,-13.60,-15.80,-17.90,-20.00,-22.10 };   

	double aE0fs[]	=	{86.96,83.79,81.28,79.17,77.45,76.17,75.07,74.02,73.09,71.37,70.05,68.87,67.81,66.88,63.45,61.21,59.23,57.38,55.92,54.74,53.55,52.62,51.57,50.77,49.98,49.45,48.92,48.66,48.13,47.87,47.6,47.47};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_3C(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{63.72,58.04,54.08,51.16,48.79,46.95,45.36,43.96,42.72,40.61,38.76,37.17,35.72,34,27.14,21.99,17.63,13.67,9.97,6.93,4.29,1.78,-0.72,-3.23,-5.61,-7.85,-9.96,-11.68,-13.4,-14.98,-16.17,-17.36};
	double aE075[]	=	{70.58,63.98,59.23,55.81,53.02,50.89,49.06,47.52,46.15,43.77,41.93,39.94,38.23,36.51,29.51,24.1,19.21,14.99,11.29,8.12,5.48,2.97,0.46,-2.04,-4.55,-6.79,-8.91,-11.02,-12.6,-14.06,-15.38,-16.57};
	double aE0150[]	=	{77.71,71.24,66.22,62.44,59.36,57.02,55,53.18,51.57,48.53,46.28,43.91,42.06,39.94,32.02,26.21,21.06,16.57,12.87,9.44,6.53,4.16,1.52,-0.98,-3.49,-5.87,-8.11,-10.1,-11.68,-13.13,-14.45,-15.77};
	double aE0300[]	=	{83.52,77.71,72.83,69.04,65.96,63.55,61.47,59.65,58.04,55,52.23,49.32,46.81,44.43,35.19,29.25,23.57,18.95,14.72,11.02,7.85,5.21,2.57,0.06,-2.44,-4.81,-7.06,-9.04,-10.76,-12.34,-13.66,-14.85};
	double aE0600[]	=	{86.83,82.07,77.98,74.71,72.04,69.63,67.55,65.59,63.85,60.15,57.51,54.74,52.36,49.72,38.76,31.76,25.81,20.8,16.83,13.01,9.44,6.8,4.03,1.38,-0.98,-3.49,-5.74,-7.85,-9.57,-11.15,-12.6,-13.92};
	double aE01200[]=	{86.83,83.66,80.75,78.64,76.92,75.15,73.62,72.08,70.71,67.81,65.3,62.39,60.02,57.24,45.62,36.91,30.57,25.15,20.4,16.04,12.34,9.44,6.27,3.63,0.99,-1.38,-3.76,-5.74,-7.72,-9.43,-11.02,-12.47};
	double aE0fs[]	=	{86.83,83.66,80.75,78.64,76.92,75.64,74.54,73.49,72.56,70.85,69.53,68.21,67.41,66.36,63.45,61.34,59.23,57.64,55.92,54.47,53.28,52.36,51.3,50.51,49.98,49.32,48.66,48.4,48,47.6,47.34,47.08};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_4C(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
/*
	double aE037[]	=	{64.64,60.68,57.77,55.53,53.55,51.96,50.64,49.59,48.26,46.42,44.57,43.25,41.93,40.87,36.12,32.42,28.98,25.55,22.12,19.48,17.1,14.72,12.61,10.63,8.78,7.33,6.01,4.82,3.76,2.7,1.91,1.12};
	double aE075[]	=	{71.11,65.7,62.26,59.62,57.51,55.66,54.34,53.02,51.7,49.59,47.74,46.15,44.83,43.51,38.62,34.79,30.7,27,23.7,20.8,18.42,16.04,13.93,11.95,10.1,8.52,7.06,5.87,4.55,3.63,2.7,1.78};
	double aE0150[]	=	{77.45,71.77,67.55,64.64,62.13,60.15,58.3,56.98,55.53,53.02,50.91,49.32,47.74,46.15,40.74,36.38,32.15,28.46,25.29,22.12,19.61,17.1,14.85,12.87,11.02,9.31,7.99,6.67,5.35,4.29,3.23,2.57};
	double aE0300[]	=	{83.79,78.11,73.88,70.45,67.41,64.9,62.92,61.21,59.75,57.11,54.87,53.28,51.57,49.98,43.51,38.62,34,30.04,26.61,23.44,20.8,18.42,16.17,13.93,12.08,10.36,8.78,7.46,6.14,5.08,4.03,3.1};
	double aE0600[]	=	{86.96,82.2,78.11,74.68,71.64,69.26,67.28,65.7,64.11,61.6,59.36,57.51,55.92,54.21,47.34,41.4,36.38,31.89,28.19,25.02,22.25,19.74,17.36,15.25,13.27,11.42,9.84,8.25,6.93,5.87,4.55,3.89};
	double aE01200[]=	{86.96,84.05,81.81,79.83,77.58,75.73,74.15,72.56,70.98,68.07,65.7,63.58,61.87,59.89,52.09,45.23,39.42,34.53,30.57,27.14,24.23,21.59,19.08,16.97,14.85,13.01,11.16,9.44,7.99,6.53,5.35,4.55};
*/
	double aE037[]	=	{64.80,60.40,57.50,55.30,53.30,52.10,50.60,49.60,48.40,46.70,45.00,43.60,42.30,41.20,36.40,32.60,29.00,25.40,22.20,19.20,16.80,14.30,12.30,10.20,8.90,7.50,6.30,5.00,3.90,2.80,2.00,1.20};
	double aE075[]	=	{71.10,66.00,62.40,59.80,57.40,55.70,54.20,52.90,51.90,49.70,47.80,46.20,45.00,43.80,38.60,34.70,30.80,27.10,23.90,20.70,18.30,15.80,13.80,11.80,10.10,8.40,7.10,5.80,4.70,3.60,2.70,1.80};
	double aE0150[]	=	{78.00,72.20,68.10,65.00,62.60,60.50,58.70,57.30,56.00,53.70,51.60,49.70,48.20,46.90,40.90,36.60,32.70,28.80,25.30,22.10,19.60,17.00,14.80,12.60,10.90,9.20,7.90,6.50,5.40,4.20,3.30,2.40};
	double aE0300[]	=	{84.50,78.10,73.70,70.10,67.00,64.80,62.70,61.30,59.90,57.20,55.00,53.00,51.50,50.00,43.80,38.40,34.00,30.00,26.50,23.20,20.60,17.90,15.70,13.40,11.70,10.00,8.70,7.30,6.20,5.00,4.00,2.90};
	double aE0600[]	=	{87.00,82.30,78.30,74.80,72.00,69.50,67.50,65.90,64.60,61.80,59.50,57.40,55.60,54.10,47.10,41.70,36.80,32.20,28.50,25.00,22.30,19.60,17.30,15.00,13.10,11.20,9.80,8.30,7.10,5.80,4.80,3.70};
	double aE01200[]=	{87.00,83.40,80.90,79.00,77.20,75.50,73.70,72.10,70.60,67.90,65.50,63.60,61.70,59.80,52.00,45.20,39.90,35.00,31.00,27.30,24.60,21.80,19.40,16.90,14.90,12.90,11.20,9.40,8.10,6.80,5.60,4.30};

	double aE0fs[]	=	{86.96,84.05,81.81,79.83,77.71,76.26,75.07,74.02,72.83,70.98,69.39,68.21,67.15,66.22,63.19,61.21,59.75,58.17,56.72,55.26,54.21,53.15,52.09,51.17,50.51,49.72,49.19,48.79,48.53,48,47.87,47.6};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_9(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{61.29,52.55,46.47,41.84,37.74,34.3,31.39,29.01,26.49,22.39,18.69,15.91,13,10.22,0.16,-6.04,-12.53,-17.69,-22.58,-27.48,-32.24,-36.74,-41.37,-45.6,-50,-54.06,-57.85,-61.39,-64.72,-67.86,-70.82,-73.64};
	double aE075[]	=	{68.69,60.23,53.88,48.72,43.82,39.99,36.81,34.16,31.39,26.62,22.65,19.21,16.17,13,1.88,-4.59,-11.34,-16.5,-21.66,-26.42,-31.18,-35.81,-40.18,-44.68,-48.91,-52.83,-56.48,-59.89,-63.1,-66.12,-68.98,-71.69};
	double aE0150[]	=	{76.77,67.9,61.82,56.39,51.63,47.39,44.22,41.18,38.13,32.18,27.29,23.45,20.14,16.44,4.13,-2.47,-9.62,-14.78,-19.8,-24.83,-29.59,-34.22,-38.59,-42.96,-47.32,-51.36,-55.13,-58.65,-61.95,-65.07,-68.02,-70.82};
	double aE0300[]	=	{84.31,76.77,70.81,65.52,60.76,56.52,52.95,49.78,46.34,39.72,34.43,30.2,26.36,22.52,8.5,0.3,-6.97,-12.53,-17.95,-22.98,-27.74,-32.37,-36.74,-41.24,-45.6,-50,-54.09,-57.91,-61.5,-64.89,-68.1,-71.14};
	double aE0600[]	=	{86.95,83.38,79.01,74.91,70.68,66.45,62.74,59.3,55.86,49.25,43.82,39.19,35.09,30.59,14.32,5.19,-3.27,-9.09,-14.78,-20.2,-25.1,-29.73,-34.36,-38.85,-43.09,-47.45,-51.52,-55.32,-58.89,-62.26,-65.44,-68.47};
	double aE01200[]=	{86.95,83.38,80.73,78.62,76.5,74.38,72.13,69.75,67.37,62.21,56.92,52.16,47.79,42.9,23.98,12.34,2.81,-4.06,-10.15,-15.83,-20.99,-25.89,-30.78,-35.28,-39.65,-44.15,-48.38,-52.34,-56.06,-59.57,-62.89,-66.03};
	double aE0fs[]	=	{86.95,83.38,80.73,78.75,77.16,75.84,74.78,73.72,72.66,70.94,69.36,68.3,67.24,66.31,63.01,61.29,59.17,57.58,56.26,54.94,53.88,52.82,52.03,51.1,50.44,49.64,49.11,48.85,48.32,48.06,47.53,47.26};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_10(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{62.18,52.69,46.36,41.49,37.4,34.5,31.6,29.49,27.51,24.75,22.77,20.53,18.68,16.31,8.27,2.6,-3.45,-8.99,-14.13,-18.88,-23.36,-27.84,-32.32,-36.54,-41.02,-45.77,-50.19,-54.32,-58.2,-61.86,-65.32,-68.61};
	double aE075[]	=	{69.43,60.07,53.88,49,44.52,41.09,37.93,35.42,33.05,28.96,26.33,23.69,21.32,18.95,9.98,4.05,-1.87,-7.41,-12.55,-17.3,-22.04,-26.52,-30.87,-35.22,-39.84,-44.32,-48.93,-53.25,-57.3,-61.12,-64.74,-68.17};
	double aE0150[]	=	{76.15,67.45,60.86,55.59,51.11,47.81,44.39,41.62,38.98,34.1,30.55,27.12,24.48,22.11,12.22,6.03,-0.03,-5.7,-10.97,-15.98,-20.72,-25.2,-29.69,-34.17,-38.39,-42.87,-47.48,-51.8,-55.85,-59.67,-63.29,-66.72};
	double aE0300[]	=	{84.06,75.5,69.56,64.82,60.07,56.51,52.56,49.53,46.63,41.49,37.4,32.79,29.36,26.2,15.25,8.4,2.34,-3.45,-8.86,-14,-19.01,-23.62,-28.1,-32.59,-37.07,-41.42,-46.03,-50.35,-54.4,-58.22,-61.84,-65.27};
	double aE0600[]	=	{86.96,83.14,78.53,73.78,69.43,65.87,62.18,58.89,55.59,49.66,45.44,41.22,37.4,32.92,20.4,12.49,5.5,-0.42,-5.96,-11.23,-16.24,-20.85,-25.6,-29.95,-34.43,-38.91,-43.53,-47.61,-51.45,-55.07,-58.49,-61.74};
	double aE01200[]=	{86.96,83.54,81.03,78.92,76.55,74.44,71.67,69.17,66.4,61.52,57.3,52.43,48.47,44.25,27.51,18.29,11.04,4.45,-1.48,-7.15,-12.29,-17.03,-21.78,-26.52,-30.87,-35.35,-39.97,-44.19,-48.4,-52.38,-56.14,-59.71};
	double aE0fs[]	=	{86.96,83.54,81.03,78.92,77.08,75.63,74.18,73.12,72.2,70.49,69.17,68.11,67.19,66.4,63.37,61.39,59.81,57.96,56.38,55.06,53.88,52.95,51.9,51.11,50.45,49.79,49.4,49,48.74,48.34,47.95,47.95};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_11(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{65.3,57.11,51.17,46.81,42.98,39.94,37.7,35.72,33.74,30.7,28.19,26.08,24.36,22.65,15.12,9.7,4.42,-0.45,-5.34,-9.57,-14.06,-18.28,-22.51,-26.73,-30.96,-35.19,-39.54,-43.77,-47.74,-51.48,-55.02,-58.38};
	double aE075[]	=	{70.58,62.92,57.11,52.36,48.4,45.36,42.85,40.74,38.62,35.06,32.15,29.78,27.53,25.42,16.7,11.16,5.74,0.86,-4.02,-8.25,-12.74,-17.23,-21.32,-25.55,-29.9,-34,-38.22,-42.58,-46.68,-50.53,-54.19,-57.65};
	double aE0150[]	=	{76.13,68.34,62.79,58.57,54.87,51.83,49.19,46.81,44.7,40.47,37.04,34.4,31.89,29.38,20,13.8,7.59,2.57,-2.3,-6.79,-11.28,-15.64,-19.87,-24.09,-28.32,-32.81,-37.04,-41.39,-45.75,-50,-54.01,-57.82};
	double aE0300[]	=	{83.26,76.13,70.58,66.09,62.13,58.7,56.06,53.68,51.04,46.55,42.85,39.81,37.04,34.13,23.97,17.23,10.36,4.95,0.06,-4.28,-8.77,-13.26,-17.75,-22.11,-26.47,-30.7,-35.19,-39.68,-44.17,-48.52,-52.65,-56.56};
	double aE0600[]	=	{86.96,81.94,77.58,73.49,69.92,66.62,64.11,61.87,59.49,55.53,51.7,48.4,45.36,42.19,30.3,20.8,13.27,7.59,2.7,-1.64,-6.4,-10.89,-15.38,-19.6,-24.09,-28.58,-32.81,-37.43,-41.92,-46.41,-50.66,-54.69};
	double aE01200[]=	{86.96,84.05,81.15,78.64,76.26,73.88,71.64,69.53,67.15,63.19,59.49,56.19,53.02,49.72,36.64,27.27,18.42,11.68,6.4,1.78,-2.96,-7.45,-12.21,-16.7,-20.92,-25.28,-29.77,-33.87,-38.09,-42.58,-46.81,-50.82};
	double aE0fs[]	=	{86.96,84.05,81.68,79.69,78.11,76.66,75.47,74.41,73.49,71.51,69.92,68.73,67.55,66.62,62.92,60.81,58.96,57.38,56.06,55,53.94,53.02,52.09,51.3,50.64,49.98,49.32,48.66,48.26,47.87,47.6,47.6};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_13(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{65.83,62.79,59.09,55.66,51.83,48.4,45.1,41.93,39.02,33.47,28.19,23.57,19.48,15.38,2.97,-4.42,-10.62,-16.83,-22.08,-26.62,-30.63,-34.22,-37.47,-40.43,-43.15,-45.67,-48.02,-50.22,-52.28,-54.23,-56.07,-57.82};
	double aE075[]	=	{71.64,68.21,64.9,61.6,58.17,54.74,51.57,48.66,45.62,39.55,33.61,28.46,23.7,19.08,5.74,-2.17,-8.64,-14.98,-20.34,-24.98,-29.08,-32.74,-36.05,-39.08,-41.86,-44.44,-46.84,-49.08,-51.19,-53.18,-55.06,-56.84};
	double aE0150[]	=	{77.45,74.15,70.98,67.68,64.24,61.07,58.3,55.53,52.49,45.76,38.76,33.08,27.93,22.91,8.65,-0.19,-6.79,-13.4,-19.21,-24.24,-28.68,-32.65,-36.24,-39.52,-42.54,-45.33,-47.94,-50.37,-52.65,-54.81,-56.85,-58.78};
	double aE0300[]	=	{83.52,80.22,77.19,74.28,71.11,68.34,65.7,62.79,59.62,52.75,45.76,39.28,32.81,27.27,11.68,2.57,-4.68,-11.28,-17.49,-22.87,-27.61,-31.85,-35.69,-39.19,-42.42,-45.4,-48.18,-50.78,-53.22,-55.52,-57.7,-59.76};
	double aE0600[]	=	{86.69,83.92,81.28,78.64,76,73.49,71.11,68.73,65.83,59.49,53.02,46.55,39.55,32.95,15.65,6.4,-0.72,-7.85,-13.92,-19.34,-24.12,-28.39,-32.25,-35.78,-39.03,-42.03,-44.83,-47.44,-49.9,-52.22,-54.41,-56.49};
	double aE01200[]=	{90,87.62,85.64,83.66,81.54,79.43,77.45,75.34,73.22,69,64.9,59.62,53.41,45.49,22.25,12.08,4.82,-2.17,-8.64,-14.19,-19.87,-24.95,-29.54,-33.74,-37.6,-41.17,-44.5,-47.61,-50.53,-53.29,-55.89,-58.36};
	double aE0fs[]	=	{86.69,82.86,80.62,78.64,76.92,75.47,74.41,73.22,72.17,70.71,69.26,68.21,67.28,66.22,62.92,60.55,58.7,57.11,55.79,54.74,53.68,52.62,51.83,51.04,50.25,49.72,48.92,48.4,47.87,47.6,47.47,47.47};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_14A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{66.36,63.72,61.47,59.36,57.24,55.26,53.55,52.23,50.51,47.34,44.43,41.53,39.28,36.91,26.87,18.55,10.89,4.29,-1.64,-7.19,-11.94,-16.43,-20.92,-24.62,-28.32,-32.02,-35.71,-39.15,-42.58,-45.75,-49.18,-52.44};
	double aE075[]	=	{72.04,69.26,66.88,64.64,62.53,60.68,58.57,57.24,55.66,52.36,48.79,45.76,43.25,40.47,29.78,21.85,13.53,6.4,0.33,-5.08,-9.83,-14.59,-19.34,-23.17,-27,-30.7,-34.39,-37.83,-41.26,-44.69,-48,-51.13};
	double aE0150[]	=	{78.64,74.94,72.3,69.92,67.81,65.7,63.72,62.26,60.55,56.85,53.41,50.51,47.87,45.1,33.74,24.76,16.31,9.04,2.44,-3.1,-7.98,-12.74,-17.75,-21.72,-25.68,-29.38,-33.07,-36.51,-39.94,-43.37,-46.81,-50.06};
	double aE0300[]	=	{84.32,80.62,77.58,74.94,72.83,70.71,68.73,67.28,65.43,62.26,59.23,56.45,53.55,50.38,38.23,28.32,19.61,11.95,5.35,-0.59,-5.74,-10.76,-15.91,-19.87,-23.83,-27.79,-31.49,-35.05,-38.62,-42.05,-45.22,-48.52};
	double aE0600[]	=	{86.96,83.52,80.88,78.37,76.26,74.41,72.56,71.37,69.79,66.62,63.45,60.55,58.04,55.4,42.45,32.42,23.44,15.65,8.78,2.44,-2.83,-7.85,-13,-17.09,-21.19,-25.41,-29.11,-32.81,-36.51,-40.07,-43.64,-46.81};
	double aE01200[]=	{90,86.69,84.05,81.81,79.69,77.85,76.13,74.94,73.36,70.71,68.07,65.7,63.45,60.81,49.59,39.81,29.78,21.59,14.33,7.72,1.91,-4.02,-9.57,-13.79,-18.28,-22.38,-26.21,-29.9,-33.6,-37.3,-40.73,-43.77};
	double aE0fs[]	=	{86.96,83.52,81.02,79.03,77.45,76,74.94,74.02,73.22,71.24,69.53,68.21,67.02,66.09,62.66,60.81,58.96,57.24,55.79,54.74,53.94,53.02,52.09,51.3,50.64,49.98,49.59,48.66,48.4,47.87,47.6,47.21};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_15A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{65.96,64.11,62.53,60.94,59.49,58.04,56.58,55.4,54.21,51.96,49.85,48,46.42,44.7,37.04,30.7,24.36,18.55,13.01,7.85,3.36,-1.12,-5.34,-8.77,-12.47,-15.91,-19.08,-21.98,-24.75,-27.53,-30.17,-32.68};
	double aE075[]	=	{71.77,69.53,67.55,65.7,63.98,62.39,60.94,59.89,58.57,56.06,53.68,51.7,49.85,47.87,39.68,32.81,26.48,20.27,14.59,9.18,4.55,0.06,-4.28,-7.72,-11.42,-14.85,-18.02,-21.19,-24.09,-26.73,-29.51,-32.15};
	double aE0150[]	=	{77.98,75.86,73.75,71.77,69.92,68.21,66.49,65.43,63.85,61.07,58.57,56.32,54.34,52.09,42.45,35.45,28.59,22.12,16.17,10.5,5.74,1.25,-3.1,-6.66,-10.1,-13.79,-16.96,-20.13,-23.17,-26.07,-28.72,-31.36};
	double aE0300[]	=	{83.52,80.62,78.11,75.73,73.88,72.17,70.45,69.39,67.81,65.04,62.53,60.41,58.43,56.19,46.42,38.49,31.1,24.36,18.02,12.34,7.46,2.57,-1.91,-5.61,-9.04,-12.74,-15.91,-19.21,-22.24,-25.28,-27.92,-30.56};
	double aE0600[]	=	{86.83,83.39,80.49,78.37,76.26,74.68,73.09,72.04,70.45,68.07,65.7,63.58,61.6,59.49,50.11,42.06,34,26.74,20.4,14.46,9.44,4.42,-0.32,-4.02,-7.72,-11.42,-14.85,-18.02,-21.19,-24.09,-26.87,-29.24};
	double aE01200[]=	{90,86.17,83.39,81.15,79.17,77.32,75.73,74.68,73.36,70.98,68.73,66.75,64.77,62.66,53.28,45.89,37.3,29.91,23.31,17.23,12.08,6.8,1.78,-2.17,-5.87,-9.57,-13,-16.43,-19.6,-22.51,-25.55,-28.19};
	double aE0fs[]	=	{86.83,83.39,81.02,78.9,77.32,75.73,74.41,73.62,72.7,71.11,69.79,68.87,67.94,67.02,63.72,61.6,59.75,58.17,56.72,55.26,54.21,53.15,52.09,51.3,50.77,49.98,49.45,48.92,48.66,48.13,47.87,47.74};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}
void CP370_Functions::F370_16A(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{65.87,65.35,65.08,64.69,64.29,64.03,63.76,63.5,63.1,62.45,61.92,61.39,60.73,60.2,57.83,55.06,50.45,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE075[]	=	{70.88,69.83,68.9,68.25,67.59,67.06,66.66,66.27,65.74,65.08,64.42,63.76,63.1,62.58,59.55,56.25,50.58,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE0150[]	=	{78.26,76.29,74.84,73.65,72.6,71.8,71.15,70.49,69.83,68.77,67.85,66.93,66.14,65.35,62.05,57.7,50.58,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE0300[]	=	{82.75,80.5,78.79,77.47,76.29,75.23,74.44,73.65,72.99,71.67,70.49,69.56,68.64,67.72,63.9,58.36,50.58,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE0600[]	=	{86.17,83.8,81.95,80.37,79.05,77.74,76.68,75.76,74.84,73.52,72.2,71.15,70.22,69.17,64.95,58.23,50.58,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE01200[]=	{90,86.7,84.46,82.75,81.03,79.71,78.79,77.87,76.95,75.36,73.91,72.86,71.54,70.49,65.08,58.1,50.58,44.25,38.85,34.37,30.68,27.25,23.95,20.92,18.02,15.25,12.75,10.38,8.27,6.29,4.45,2.86};
	double aE0fs[]	=	{86.17,83.14,80.77,78.92,77.21,75.89,74.7,73.65,72.86,71.28,69.83,68.64,67.59,66.8,63.1,60.6,58.75,57.17,55.99,54.8,54.01,52.95,52.16,51.37,50.58,49.79,49.26,48.87,48.34,47.95,47.68,47.55};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}
void CP370_Functions::F370_14B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{66.22,63.06,60.41,58.3,56.45,54.6,53.41,52.23,50.91,48.53,46.42,44.83,43.25,41.66,35.98,31.89,27.93,24.23,20.53,17.1,13.67,10.36,7.06,3.89,0.99,-1.64,-4.15,-6.4,-8.64,-10.62,-12.6,-14.19};
	double aE075[]	=	{72.17,69.13,66.49,64.38,62.53,60.68,59.09,57.51,56.19,53.55,51.43,49.45,47.74,46.15,39.94,35.32,30.83,26.61,22.65,18.95,15.51,12.08,8.78,5.48,2.44,-0.32,-2.83,-5.08,-7.32,-9.43,-11.42,-13.26};
	double aE0150[]	=	{77.98,74.41,71.77,69.53,67.28,65.17,63.58,62,60.41,57.51,55.13,53.02,51.17,49.59,42.85,37.96,33.47,28.98,24.76,20.8,17.36,13.67,10.23,7.06,3.89,0.99,-1.64,-3.89,-6.13,-8.11,-10.23,-11.94};
	double aE0300[]	=	{83.92,80.35,77.58,75.2,72.83,70.85,69.13,67.41,65.7,62.66,59.89,57.64,55.53,53.41,46.02,41,36.12,31.63,27.14,22.91,19.21,15.51,11.82,8.65,5.48,2.57,-0.06,-2.44,-4.68,-6.79,-8.77,-10.49};
	double aE0600[]	=	{87.09,83.26,80.75,78.77,76.66,74.68,72.96,71.51,69.79,66.75,63.85,61.47,59.36,57.11,49.59,44.43,39.42,34.66,30.04,25.68,21.85,17.89,14.06,10.63,7.46,4.42,1.78,-0.72,-3.1,-5.34,-7.32,-8.91};
	double aE01200[]=	{90,86.56,83.92,81.81,79.69,77.71,76,74.54,73.09,70.05,67.41,65.3,63.19,61.21,53.41,48,42.85,38.1,33.61,29.25,25.02,20.8,16.97,13.4,9.97,7.06,4.16,1.52,-0.98,-3.23,-5.21,-6.79};
	double aE0fs[]	=	{86.96,83.39,80.75,78.77,77.19,75.73,74.68,73.62,72.56,70.85,69.26,68.21,67.28,66.36,63.45,61.34,59.62,57.9,56.58,55.26,54.47,53.41,52.62,51.7,51.04,50.25,49.45,48.92,48.4,47.87,47.34,47.21};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

void CP370_Functions::F370_15B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{66.14,63.9,62.05,60.6,59.15,57.83,56.78,55.99,54.93,53.35,51.77,50.71,49.66,48.6,44.25,41.22,38.06,34.63,31.2,28.17,24.88,21.98,18.95,15.91,12.88,9.98,7.35,4.71,2.2,-0.16,-2.53,-4.64};
	double aE075[]	=	{71.8,69.43,67.32,65.48,63.76,62.31,61.13,60.07,58.89,57.04,55.2,53.88,52.56,51.37,46.76,43.6,39.9,36.48,33.05,29.89,26.46,23.3,20.13,16.97,13.8,11.04,8.14,5.5, 3,0.49,-1.74,-3.72};
	double aE0150[]	=	{78.13,75.36,73.12,71.28,69.43,67.85,66.53,65.21,63.9,61.79,59.94,58.36,57.04,55.46,49.92,46.5,42.54,38.72,35.03,31.6,28.04,24.61,21.32,17.89,14.86,11.7,9.06,6.29,3.79,1.28,-1.08,-2.93};
	double aE0300[]	=	{83.4,80.24,77.6,75.36,73.39,71.8,70.35,69.17,67.85,65.48,63.37,61.79,60.2,58.62,52.82,48.6,44.65,40.7,36.74,33.05,29.36,25.67,22.24,18.81,15.65,12.62,9.59,7.08,4.71,2.07,-0.16,-2.14};
	double aE0600[]	=	{86.7,83.4,80.77,78.66,76.68,74.97,73.39,72.07,70.75,68.11,65.87,64.03,62.31,60.73,54.67,50.45,46.1,42.01,38.06,34.37,30.68,26.99,23.3,19.87,16.7,13.54,10.51,7.87,5.37, 3,0.75,-1.35};
	double aE01200[]=	{90,86.3,83.67,81.3,79.19,77.34,75.76,74.44,72.86,70.22,68.11,66.27,64.42,62.84,56.51,52.03,47.55,43.33,39.38,35.82,32,28.3,24.61,21.05,17.76,14.46,11.43,8.8,6.16,3.79,1.41,-0.55};
	double aE0fs[]	=	{86.7,83.4,80.77,78.66,76.68,75.23,73.91,72.99,71.94,70.22,69.04,67.98,66.93,66.14,62.97,61.13,59.15,57.44,55.99,54.8,53.48,52.43,51.5,50.58,49.79,49.26,48.6,47.95,47.42,47.15,46.89,46.63};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}
void CP370_Functions::F370_16B(double *E037,double *E075,double *E0150,double *E0300,double *E0600,double *E01200,double *E0fs) 
{
	double aE037[]	=	{66.4,65.87,65.08,64.69,64.29,63.76,63.5,63.24,62.97,62.45,61.92,61.39,61.13,60.86,59.15,57.17,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE075[]	=	{70.88,70.22,69.56,68.9,68.25,67.59,67.06,66.66,66.14,65.35,64.69,64.03,63.5,62.84,60.07,57.96,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE0150[]	=	{78.26,76.42,74.97,73.91,72.86,72.07,71.28,70.75,70.09,68.77,67.72,66.8,66,64.95,61,57.83,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE0300[]	=	{83.01,80.77,79.05,77.74,76.55,75.5,74.44,73.78,72.86,71.28,69.96,68.9,67.98,66.8,62.45,58.89,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE0600[]	=	{86.96,84.2,82.22,80.64,79.32,78.13,76.95,76.15,75.23,73.65,72.07,70.88,69.7,68.64,63.5,58.75,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE01200[]=	{90,87.1,85.12,83.4,81.82,80.64,79.58,78.66,77.74,76.02,74.44,73.12,71.8,70.49,64.29,58.75,53.88,49.92,46.36,43.07,40.43,37.53,34.76,32.39,29.89,27.51,25.14,22.9,20.79,18.68,16.7,14.73};
	double aE0fs[]	=	{86.83,84.2,81.95,79.98,78.26,76.95,75.63,74.84,73.78,71.8,70.09,69.04,67.98,66.8,63.24,61.26,59.68,58.23,56.91,55.59,54.54,53.48,52.43,51.5,50.58,49.79,49.13,48.47,48.08,47.55,47.15,46.89};
	for(int i=0;i<32;i++)
	{
		E037[i]		=	aE037[i];
		E075[i]		=	aE075[i];
		E0150[i]	=	aE0150[i];
		E0300[i]	=	aE0300[i];
		E0600[i]	=	aE0600[i];
		E01200[i]	=	aE01200[i];
		E0fs[i]		=	aE0fs[i];
	}
}

double CP370_Functions::Interp1I(double *E0,double *D0,double E,int num) 
{
	double d1,d2,E1,E2,Db;
	if (E>E0[0])
	{
		d1=D0[0];d2=D0[1];
		E1=E0[0];E2=E0[1];
	}
	else if (E<E0[num-1])
	{
		d1=D0[num-2];d2=D0[num-1];
		E1=E0[num-2];E2=E0[num-1];
	}
	else
	{
		/////////////////////////////////////////////
		int n1=0;
		while(E<=E0[n1])
		{
			n1++;
			if (n1==num)
				break;
		}
		if (n1==0)
			n1=1;
		d1=D0[n1-1];E1=E0[n1-1];
		///////////////////////////////////////////////
		int n2=num-1;
		while(E>=E0[n2])
		{
			n2--;
			if (n2==0)
				break;
		}
		d2=D0[n2+1];E2=E0[n2+1];
		////////////////////////////////////////////////
	}
	Db=((E1==E2) ? d1 : d1*pow(10.0,(log10(d2/d1))*(E-E1)/(E2-E1)) );
	return Db;
}
/*
double CP370_Functions::P370_0I(double f,double t,int p,double h1,double E) 
{
	//p=1=='Land'  p=2=='Cold Sea' p=3=='Warm Sea'
	//	double h0[]		=	{37.5,75,150,300,600,1200};
	double D0[]		=	{10.0,15.0,20.0,25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.0,150.0,200.0,250.0,300.0,350.0,400.0,450.0,500.0,550.0,600.0,650.0,700.0,750.0,800.0,850.0,900.0,950.0,1000.0};
	double E037[32],E075[32],E0150[32],E0300[32],E0600[32],E01200[32],E0fs[32];	
	
	if ( (f>=30.0) && (f<=250.0) )
	{
		if ( (t==50) && (p==1) ) 
			F370_1A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )
			F370_2A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==1) )
			F370_3A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==1) )
			F370_4A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))
			F370_1B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )
			F370_2B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==2) )
			F370_3B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==2) )
			F370_4B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )
			F370_2C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==3) )
			F370_3C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==3) )
			F370_4C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}
	else if ( (f>=450.0) && (f<=1000.0) )
	{
		if ( (t==50) && (p==1) )
			F370_9(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )
			F370_10(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==1) )
			F370_11(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))
			F370_13(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )
			F370_14A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==2) )
			F370_15A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==2) )
			F370_16A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )
			F370_14B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==3) )
			F370_15B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==3) )
			F370_16B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}
	double E0[32];
	int i;

	if(h1==37.5)
		for (i=0;i<32;i++)
			E0[i]=E037[i];
	else if(h1==75.0)
		for (i=0;i<32;i++)
			E0[i]=E075[i];
	else if(h1==150.0)
		for (i=0;i<32;i++)
			E0[i]=E0150[i];
	else if(h1==300.0)
		for (i=0;i<32;i++)
			E0[i]=E0300[i];
	else if(h1==600.0)
		for (i=0;i<32;i++)
			E0[i]=E0600[i];
	else if(h1==1200.0)
		for (i=0;i<32;i++)
			E0[i]=E01200[i];
	double Db=Interp1I(E0,D0, E,32);
	return Db;
}

double CP370_Functions::P370_1I(double f,double t,int p,double h1,double E) 
{
	double Db=0.0;
	if ( (h1==37.5) || (h1==75.0) || (h1==150.0) || (h1==300.0) || (h1==600.0) || (h1==1200.0) )
		Db= P370_0I( f , t , p , h1 , E  );
	else
	{
		double h11,h12,d1,d2;
		
		if		( (h1 > 37.5) && (h1 < 75.0  ) ) {h11=37.5;h12=75.0;  }
		else if ( (h1 > 75.0  ) && (h1 < 150.0 ) ) {h11=75.0  ;h12=150.0; }
		else if ( (h1 > 150.0 ) && (h1 < 300.0 ) ) {h11=150.0 ;h12=300.0; }
		else if ( (h1 > 300.0 ) && (h1 < 600.0 ) ) {h11=300.0 ;h12=600.0; }
		else if ( (h1 > 600.0 ) && (h1 < 1200.0) ) {h11=600.0 ;h12=1200.0;}
		d1=P370_0I( f , t , p , h11 , E );
		d2=P370_0I( f , t , p , h12 , E );
		Db=d1+(d2-d1)*(h1-h11)/(h12-h11);
	}
	return Db;
}

double CP370_Functions::P370_2I(double f,double t,int p,double h1,double E,double tetamax15) 
{
	double Db = 0.0,E0fs;

	if ( (h1>=37.5) && (h1<=1200.0) )
		Db = P370_1I(f,t,p,h1,E);
	else if ( (h1>=0.0) && (h1<37.5) )
	{
		double dh1 = 4.1*sqrt(h1);
		double E2 =  P370_2(f,t,p,h1,dh1,tetamax15,&E0fs);
		if (E>E2)
		{
			double E1 = E + P370_1(f,t,p,37.5,dh1,&E0fs) - P370_1(f,t,p,37.5,4.1*sqrt(37.5),&E0fs);
			Db = P370_1I(f,t,p,37.5,E1);
		}
		else
			Db = dh1 - 4.1*sqrt(37.5) + P370_1I(f,t,p,37.5,E);
	}
	else if ( h1>1200.0 )
	{
		double dh1 = 4.1*sqrt(h1);
		double E2 =  P370_2(f,t,p,h1,dh1,tetamax15,&E0fs);
		if (E>E2)
		{
			double E1 = E + P370_1(f,t,p,1200.0,dh1,&E0fs) - P370_1(f,t,p,1200.0,4.1*sqrt(1200.0),&E0fs);
			Db = P370_1I(f,t,p,1200.0,E1);
		}
		else
			Db = dh1 - 4.1*sqrt(1200.0) + P370_1I(f,t,p,1200.0,E);
	}
	else if ( h1<0.0 )
	{
		double E1 = E - TCAcorr370(tetamax15,f);
		Db = P370_2I(f,t,p,0.0,E1,tetamax15);
	}
	return Db;
}

double CP370_Functions::P370_3I(double f,double t,int p,double h1,double E,
								 double tetamax15,double h2,int ENV) 
{
	h2 = max(h2,0.0000000001);
	double Db = 0.0 ,HG,c;
	if (h2==10.0)
		HG = 0.0;
	else
	{
		if ( (f>=30.0) && (f<=250.0) )
			c=4.0*(ENV==1)+5.0*(ENV==2)+6.0*(ENV==3);
		else if ( (f>=450.0) && (f<=1000.0) )
			c=4.0*(ENV==1)+6.0*(ENV==2)+8.0*(ENV==3);
		HG = (c/6.0)*20.0*log10(h2/10.0);
	}
	double E1 = E - HG;
	Db = P370_2I(f,t,p,h1,E1,tetamax15);

	return Db;
}


double CP370_Functions::P370_4I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst) 
{
	int i;
	double Db  ,corr,cort[15];
	double cort1[15]={19.0313, 16.7857, 13.4393, 10.3571, 6.6585, 3.9726, 1.727, 0, -1.7955, -4.0851, -6.6389, -10.4256, -13.5078, -16.8542, -18.9237};
	double cort2[15]={11.7661, 10.4012, 8.3757, 6.4824, 4.0607, 2.5636, 1.1546, 0, -1.047, -2.3679, -3.9971, -6.2867, -8.18, -10.2495, -11.4384};
	double cort3[15]={21.6309, 19.082, 15.3906, 11.875, 7.6563, 4.4922, 2.0313, 0, -2.0117, -4.4727, -7.6367, -11.7676, -15.2832, -19.0625, -21.5234};
	double cort4[15]={12.8418, 11.3477, 9.0625, 6.9531, 4.3164, 2.5586, 1.1523, 0, -1.3086, -2.7148, -4.4727, -7.1094, -9.043, -11.3281, -12.9102};

	if (Lp==50.0)
		corr=0.0;
	else
	{
		double Lpt[15]={1, 2, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 95, 98, 99};
		if ( (f>=30.0) && (f<=250.0) )
		{
			if (syst==1)  //A
				for (i=0;i<15;i++)
					cort[i]=cort1[i];
			else if (syst==2)  //D 
				for (i=0;i<15;i++)
					cort[i]=cort2[i];
		}   
		else if ( (f>=450.0) && (f<=1000.0) )
		{
			if (syst==1)  //A
				for (i=0;i<15;i++)
					cort[i]=cort3[i];
			else if (syst==2)  //D 
				for (i=0;i<15;i++)
					cort[i]=cort4[i];
		}
		corr=Interp2(Lpt,cort,Lp,15);
	} 
	double E1 = E - corr;
	Db = P370_3I(f,t,p,h1,E1,tetamax15,h2,ENV);
	return Db;
}

double CP370_Functions::P370_5I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst) 
{
	double Db = 0.0;
	t=min(max(t,1),50);
	double tinf,tsup,Qt,Qinf,Qsup;
double Dinf,Dsup;

	if ( ((f>=450.0) && (f<=1000.0)) && ((t>1.0) && (t<10.0)) && p==1)
	{
	   tinf=1.0;	tsup=10.0;
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Dinf = P370_4I(f,tinf,p,h1,E,tetamax15,h2,ENV,Lp,syst);
	   Dsup = P370_4I(f,tsup,p,h1,E,tetamax15,h2,ENV,Lp,syst);

	   Db = log10(Dsup)*(Qinf-Qt)/(Qinf-Qsup)+log10(Dinf)*(Qt-Qsup)/(Qinf-Qsup);
	   Db = pow(10.0,Db);
	}
	else if ( (t==1.0) || (t==5.0) || (t==10.0) || (t==50.0) ) 
	{
		Db = P370_4I(f,t,p,h1,E,tetamax15,h2,ENV,Lp,syst);
	}
	else
	{
	   if ((t>1.0) && (t<5.0) )
	   {
		   tinf=1.0;tsup=5.0;
	   }
	   else if ( (t>5.0) && (t<10.0) )
	   {
		   tinf=5.0;tsup=10.0;
	   }
	   else if ( (t>10.0) && (t<50.0) )
	   {
		   tinf=10.0;tsup=50.0;
	   }
   
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Dinf = P370_4I(f,tinf,p,h1,E,tetamax15,h2,ENV,Lp,syst);
	   Dsup = P370_4I(f,tsup,p,h1,E,tetamax15,h2,ENV,Lp,syst);

	   Db = log10(Dsup)*(Qinf-Qt)/(Qinf-Qsup)+log10(Dinf)*(Qt-Qsup)/(Qinf-Qsup);
	   Db = pow(10.0,Db);
	}
	return Db;
}

double CP370_Functions::P370_6I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double ttca) 
{
	double Db = 0.0, corr_ca,Ecorr;

	corr_ca = TCAcorr370(ttca,f);

	// if p==1
	//   corr_dh=zdelta_h_cr(f,d_km,dh);
	// else
	//   corr_dh=0;
	// end 
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	//Ecorr = corr_ca - corr_dh;
	Ecorr = corr_ca;
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	double E1 = E - Ecorr;
	Db = P370_5I(f,t,p,h1,E1,tetamax15,h2,ENV,Lp,syst);
	return Db;
}

double CP370_Functions::P370_7I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double ttca) 
{
	double Db;

	if (((f>=30.0) && (f<=250.0)) || ((f>=450.0) && (f<=1000.0)))
		Db = P370_6I(f,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,ttca);
	else if ( (f>250.0) && (f<450.0))
	{
		double finf,fsup,Dbinf,Dbsup;
		finf=250.0;fsup=450.0;

		Dbinf = P370_6I(finf,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,ttca);
		Dbsup = P370_6I(fsup,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,ttca);

		Db = Dbinf+(Dbsup-Dbinf)*(f-finf)/(fsup-finf);
	}   
	return Db;
}
*/


double CP370_Functions::P370_0I(double f,double t,int p,double h1,double E,double Delta_H) 
{
	//p=1=='Land'  p=2=='Cold Sea' p=3=='Warm Sea'
	//	double h0[]		=	{37.5,75,150,300,600,1200};
	double D0[]		=	{10.0,15.0,20.0,25.0,30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.0,150.0,200.0,250.0,300.0,350.0,400.0,450.0,500.0,550.0,600.0,650.0,700.0,750.0,800.0,850.0,900.0,950.0,1000.0};
	double E037[32],E075[32],E0150[32],E0300[32],E0600[32],E01200[32],E0fs[32];	
	
	if ( (f>=30.0) && (f<=250.0) )
	{
		if ( (t==50) && (p==1) ) 
			F370_1A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )
			F370_2A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==1) )
			F370_3A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==1) )
			F370_4A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))
			F370_1B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )
			F370_2B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==2) )
			F370_3B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==2) )
			F370_4B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )
			F370_2C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==3) )
			F370_3C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==3) )
			F370_4C(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}
	else if ( (f>=450.0) && (f<=1000.0) )
	{
		if ( (t==50) && (p==1) )
			F370_9(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==1) )
			F370_10(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==1) )
			F370_11(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==50) && ((p==2) || (p==3)))
			F370_13(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==2) )
			F370_14A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==2) )
			F370_15A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==2) )
			F370_16A(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==10) && (p==3) )
			F370_14B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==5) && (p==3) )
			F370_15B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
		else if ( (t==1) && (p==3) )
			F370_16B(E037,E075,E0150,E0300,E0600,E01200,E0fs) ;
	}


	double E0[32];
	int i;

	if(h1==37.5)
		for (i=0;i<32;i++)
			E0[i]=E037[i];
	else if(h1==75.0)
		for (i=0;i<32;i++)
			E0[i]=E075[i];
	else if(h1==150.0)
		for (i=0;i<32;i++)
			E0[i]=E0150[i];
	else if(h1==300.0)
		for (i=0;i<32;i++)
			E0[i]=E0300[i];
	else if(h1==600.0)
		for (i=0;i<32;i++)
			E0[i]=E0600[i];
	else if(h1==1200.0)
		for (i=0;i<32;i++)
			E0[i]=E01200[i];

	if (p==1)
	for (i=0;i<32;i++)
		E0[i] = E0[i] - zdelta_h_cr(f,D0[i],Delta_H);

	double Db=Interp1I(E0,D0, E,32);
	return Db;
}

double CP370_Functions::P370_1I(double f,double t,int p,double h1,double E,double Delta_H) 
{
	double Db=0.0;
	if ( (h1==37.5) || (h1==75.0) || (h1==150.0) || (h1==300.0) || (h1==600.0) || (h1==1200.0) )
		Db= P370_0I( f , t , p , h1 , E , Delta_H);
	else
	{
		double h11,h12,d1,d2;
		
		if		( (h1 > 37.5) && (h1 < 75.0  ) ) {h11=37.5;h12=75.0;  }
		else if ( (h1 > 75.0  ) && (h1 < 150.0 ) ) {h11=75.0  ;h12=150.0; }
		else if ( (h1 > 150.0 ) && (h1 < 300.0 ) ) {h11=150.0 ;h12=300.0; }
		else if ( (h1 > 300.0 ) && (h1 < 600.0 ) ) {h11=300.0 ;h12=600.0; }
		else if ( (h1 > 600.0 ) && (h1 < 1200.0) ) {h11=600.0 ;h12=1200.0;}
		d1 = P370_0I( f , t , p , h11 , E , Delta_H);
		d2 = P370_0I( f , t , p , h12 , E , Delta_H);
		Db = d1+(d2-d1)*(h1-h11)/(h12-h11);
	}
	return Db;
}

double CP370_Functions::P370_2I(double f,double t,int p,double h1,double E,double tetamax15,double Delta_H) 
{
	double Db = 0.0,E0fs;

	if ( (h1>=37.5) && (h1<=1200.0) )
		Db = P370_1I(f,t,p,h1,E,Delta_H);
	else if ( (h1>=0.0) && (h1<37.5) )
	{
		double dh1 = 4.1*sqrt(h1);
		double E2 =  P370_2(f,t,p,h1,dh1,tetamax15,&E0fs) - zdelta_h_cr(f,dh1,Delta_H);
		if (E>E2)
		{
			double E1 = E + P370_1(f,t,p,37.5,dh1,&E0fs) - zdelta_h_cr(f,dh1,Delta_H) - P370_1(f,t,p,37.5,4.1*sqrt(37.5),&E0fs) + zdelta_h_cr(f,4.1*sqrt(37.5),Delta_H);
			Db = P370_1I(f,t,p,37.5,E1,Delta_H);
		}
		else
			Db = dh1 - 4.1*sqrt(37.5) + P370_1I(f,t,p,37.5,E,Delta_H);
	}
	else if ( h1>1200.0 )
	{
		double dh1 = 4.1*sqrt(h1);
		double E2 =  P370_2(f,t,p,h1,dh1,tetamax15,&E0fs) - zdelta_h_cr(f,dh1,Delta_H);
		if (E>E2)
		{
			double E1 = E + P370_1(f,t,p,1200.0,dh1,&E0fs) - zdelta_h_cr(f,dh1,Delta_H) - P370_1(f,t,p,1200.0,4.1*sqrt(1200.0),&E0fs) - zdelta_h_cr(f,4.1*sqrt(1200.0),Delta_H);
			Db = P370_1I(f,t,p,1200.0,E1,Delta_H);
		}
		else
			Db = dh1 - 4.1*sqrt(1200.0) + P370_1I(f,t,p,1200.0,E,Delta_H);
	}
	else if ( h1<0.0 )
	{
		double E1 = E - TCAcorr370(tetamax15,f);
		Db = P370_2I(f,t,p,0.0,E1,tetamax15,Delta_H);
	}
	return Db;
}

double CP370_Functions::P370_3I(double f,double t,int p,double h1,double E,
								 double tetamax15,double h2,int ENV,double Delta_H) 
{
	h2 = max(h2,0.0000000001);
	double Db = 0.0 ,HG,c;
	if (h2==10.0)
		HG = 0.0;
	else
	{
		if ( (f>=30.0) && (f<=250.0) )
			c=4.0*(ENV==1)+5.0*(ENV==2)+6.0*(ENV==3);
		else if ( (f>=450.0) && (f<=1000.0) )
			c=4.0*(ENV==1)+6.0*(ENV==2)+8.0*(ENV==3);
		HG = (c/6.0)*20.0*log10(h2/10.0);
	}
	double E1 = E - HG;
	Db = P370_2I(f,t,p,h1,E1,tetamax15,Delta_H);

	return Db;
}


double CP370_Functions::P370_4I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double Delta_H) 
{
	int i;
	double Db  ,corr,cort[15];
	double cort1[15]={19.0313, 16.7857, 13.4393, 10.3571, 6.6585, 3.9726, 1.727, 0, -1.7955, -4.0851, -6.6389, -10.4256, -13.5078, -16.8542, -18.9237};
	double cort2[15]={11.7661, 10.4012, 8.3757, 6.4824, 4.0607, 2.5636, 1.1546, 0, -1.047, -2.3679, -3.9971, -6.2867, -8.18, -10.2495, -11.4384};
	double cort3[15]={21.6309, 19.082, 15.3906, 11.875, 7.6563, 4.4922, 2.0313, 0, -2.0117, -4.4727, -7.6367, -11.7676, -15.2832, -19.0625, -21.5234};
	double cort4[15]={12.8418, 11.3477, 9.0625, 6.9531, 4.3164, 2.5586, 1.1523, 0, -1.3086, -2.7148, -4.4727, -7.1094, -9.043, -11.3281, -12.9102};

	if (Lp==50.0)
		corr=0.0;
	else
	{
		double Lpt[15]={1, 2, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 95, 98, 99};
		if ( (f>=30.0) && (f<=250.0) )
		{
			if (syst==1)  //A
				for (i=0;i<15;i++)
					cort[i]=cort1[i];
			else if (syst==2)  //D 
				for (i=0;i<15;i++)
					cort[i]=cort2[i];
		}   
		else if ( (f>=450.0) && (f<=1000.0) )
		{
			if (syst==1)  //A
				for (i=0;i<15;i++)
					cort[i]=cort3[i];
			else if (syst==2)  //D 
				for (i=0;i<15;i++)
					cort[i]=cort4[i];
		}
		corr=Interp2(Lpt,cort,Lp,15);
	} 
	double E1 = E - corr;
	Db = P370_3I(f,t,p,h1,E1,tetamax15,h2,ENV,Delta_H);
	return Db;
}

double CP370_Functions::P370_5I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double Delta_H) 
{
	double Db = 0.0;
	t=min(max(t,1),50);
	double tinf,tsup,Qt,Qinf,Qsup,Dinf,Dsup;

	if ( ((f>=450.0) && (f<=1000.0)) && ((t>1.0) && (t<10.0)) && p==1)
	{
	   tinf=1.0;	tsup=10.0;
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Dinf = P370_4I(f,tinf,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
	   Dsup = P370_4I(f,tsup,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);

	   Db = log10(Dsup)*(Qinf-Qt)/(Qinf-Qsup)+log10(Dinf)*(Qt-Qsup)/(Qinf-Qsup);
	   Db = pow(10.0,Db);
	}
	else if ( (t==1.0) || (t==5.0) || (t==10.0) || (t==50.0) ) 
	{
		Db = P370_4I(f,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
	}
	else
	{
	   if ((t>1.0) && (t<5.0) )
	   {
		   tinf=1.0;tsup=5.0;
	   }
	   else if ( (t>5.0) && (t<10.0) )
	   {
		   tinf=5.0;tsup=10.0;
	   }
	   else if ( (t>10.0) && (t<50.0) )
	   {
		   tinf=10.0;tsup=50.0;
	   }
   
	   Qt=Qi(t);   Qinf=Qi(tinf);   Qsup=Qi(tsup);

	   Dinf = P370_4I(f,tinf,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
	   Dsup = P370_4I(f,tsup,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);

	   Db = log10(Dsup)*(Qinf-Qt)/(Qinf-Qsup)+log10(Dinf)*(Qt-Qsup)/(Qinf-Qsup);
	   Db = pow(10.0,Db);
	}
	return Db;
}
/*
double CP370_Functions::P370_6I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double ttca) 
{
	double Db = 0.0, corr_ca,Ecorr;

	corr_ca = TCAcorr370(ttca,f);

	// if p==1
	//   corr_dh=zdelta_h_cr(f,d_km,dh);
	// else
	//   corr_dh=0;
	// end 
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	//Ecorr = corr_ca - corr_dh;
	Ecorr = corr_ca;
	//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	double E1 = E - Ecorr;
	Db = P370_5I(f,t,p,h1,E1,tetamax15,h2,ENV,Lp,syst);
	return Db;
}
*/
double CP370_Functions::P370_7I(double f,double t,int p,double h1,double E,
						 double tetamax15,double h2,int ENV,double Lp,int syst,double Delta_H) 
{
	double Db;

	if (((f>=30.0) && (f<=250.0)) || ((f>=450.0) && (f<=1000.0)))
		Db = P370_5I(f,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
	else if ( (f>250.0) && (f<450.0))
	{
		double finf,fsup,Dbinf,Dbsup;
		finf=250.0;fsup=450.0;

		Dbinf = P370_5I(finf,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
		Dbsup = P370_5I(fsup,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);

		Db = Dbinf+(Dbsup-Dbinf)*(f-finf)/(fsup-finf);
	} 
///////////////////////////////////////
	else if (f<30.0)
	{
		double finf,fsup,Dbinf,Dbsup;
		finf=30.0;fsup=250.0;

		Dbinf = P370_5I(finf,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
		Dbsup = P370_5I(fsup,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);

		Db = Dbinf+(Dbsup-Dbinf)*(f-finf)/(fsup-finf);
	} 
	else if (f>1000.0)
	{
		double finf,fsup,Dbinf,Dbsup;
		finf=450.0;fsup=1000.0;

		Dbinf = P370_5I(finf,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);
		Dbsup = P370_5I(fsup,t,p,h1,E,tetamax15,h2,ENV,Lp,syst,Delta_H);

		Db = Dbinf+(Dbsup-Dbinf)*(f-finf)/(fsup-finf);
	} 
///////////////////////////////////////////////
	return Db;
}

double CP370_Functions::Delta_H_cr(double f,double d,double dh)
{
	double y;

	if (((f>=30.0) && (f<=250.0)) || ((f>=450.0) && (f<=1000.0)))
		y = zdelta_h_cr( f, d, dh);
	else if ( (f>250.0) && (f<450.0))
	{
		double finf,fsup,yinf,ysup;
		finf=250.0;fsup=450.0;

		yinf = zdelta_h_cr( finf, d, dh);
		ysup = zdelta_h_cr( fsup, d, dh);

		y = yinf+(ysup-yinf)*log10(f/finf)/log10(fsup/finf);
	}   
	return y;

}
